!function(t){var e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={i:i,l:!1,exports:{}};return t[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=t,r.c=e,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:i})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=18)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(1),n=r(19),a=r(20),s=r(7),o=r(8),l=r(9),u=r(21),c=r(22),h=r(10),d=r(11);r.d(e,"glMatrix",function(){return i}),r.d(e,"mat2",function(){return n}),r.d(e,"mat2d",function(){return a}),r.d(e,"mat3",function(){return s}),r.d(e,"mat4",function(){return o}),r.d(e,"quat",function(){return l}),r.d(e,"quat2",function(){return u}),r.d(e,"vec2",function(){return c}),r.d(e,"vec3",function(){return h}),r.d(e,"vec4",function(){return d})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),r.d(e,"ARRAY_TYPE",function(){return n}),e.setMatrixArrayType=function(t){n=t},e.toRadian=function(t){return t*s},e.equals=function(t,e){return Math.abs(t-e)<=i*Math.max(1,Math.abs(t),Math.abs(e))};const i=1e-6;e.EPSILON=i;let n="undefined"!=typeof Float32Array?Float32Array:Array;const a=Math.random;e.RANDOM=a;const s=Math.PI/180},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(0);let n=r(3);class a{constructor(t){this.mesh=t,this.initialized=!1,this.rotation_offset=i.vec3.fromValues(0,0,0)}static initWithShader(t,e){this.shader=e,t.bindAttribLocation(e.ID,0,"a_vertex"),t.bindAttribLocation(e.ID,1,"a_tex_coord"),t.bindAttribLocation(e.ID,2,"a_normal"),t.bindVertexArray(null),a.emptyTexture=t.createTexture(),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,a.emptyTexture);const r=new Uint8Array([0,0,0,255]);t.texImage2D(t.TEXTURE_2D,0,t.RGB,1,1,0,t.RGB,t.UNSIGNED_BYTE,r)}static setMVPMatrices(t,e,r){let n=i.mat4.create();i.mat4.mul(n,e,t),i.mat4.mul(n,r,n),this.shader.setMat4(this.shader.uniforms.model_matrix,t),this.shader.setMat4(this.shader.uniforms.model_view_projection_matrix,n)}static use(t){}init(t){this.VAO=t.createVertexArray(),n.initMeshBuffers(t,this.mesh),t.bindVertexArray(this.VAO),t.enableVertexAttribArray(0),t.bindBuffer(t.ARRAY_BUFFER,this.mesh.vertexBuffer),t.vertexAttribPointer(0,3,t.FLOAT,!1,0,0),t.enableVertexAttribArray(1),t.bindBuffer(t.ARRAY_BUFFER,this.mesh.textureBuffer),t.vertexAttribPointer(1,2,t.FLOAT,!0,0,0),t.enableVertexAttribArray(2),t.bindBuffer(t.ARRAY_BUFFER,this.mesh.normalBuffer),t.vertexAttribPointer(2,3,t.FLOAT,!1,0,0),this.textures=[],this.initAllTextures(t),this.initialized=!0}initAllTextures(t){for(let e=0;e<this.mesh.materialNames.length;e++)this.mesh.materialsByIndex[e].mapDiffuse&&(this.mesh.materialsByIndex[e].mapDiffuse.texture.complete?this.mesh.materialsByIndex[e].mapDiffuse.texture_id=this.loadTexture(t,e,this.mesh.materialsByIndex[e].mapDiffuse.texture):this.mesh.materialsByIndex[e].mapDiffuse.texture.addEventListener("load",()=>{this.mesh.materialsByIndex[e].mapDiffuse.texture_id=this.loadTexture(t,e,this.mesh.materialsByIndex[e].mapDiffuse.texture)})),this.mesh.materialsByIndex[e].mapAmbient&&(this.mesh.materialsByIndex[e].mapAmbient.texture.complete?this.mesh.materialsByIndex[e].mapAmbient.texture_id=this.loadTexture(t,e,this.mesh.materialsByIndex[e].mapAmbient.texture):this.mesh.materialsByIndex[e].mapAmbient.texture.addEventListener("load",()=>{this.mesh.materialsByIndex[e].mapAmbient.texture_id=this.loadTexture(t,e,this.mesh.materialsByIndex[e].mapAmbient.texture)})),this.mesh.materialsByIndex[e].mapEmissive&&(this.mesh.materialsByIndex[e].mapEmissive.texture.complete?this.mesh.materialsByIndex[e].mapEmissive.texture_id=this.loadTexture(t,e,this.mesh.materialsByIndex[e].mapEmissive.texture):this.mesh.materialsByIndex[e].mapEmissive.texture.addEventListener("load",()=>{this.mesh.materialsByIndex[e].mapEmissive.texture_id=this.loadTexture(t,e,this.mesh.materialsByIndex[e].mapEmissive.texture)}))}initTexture(t,e,r=!0){return!!this.mesh.materialsByIndex[e]&&(this.mesh.materialsByIndex[e].mapDiffuse.texture.complete?this.loadTexture(t,e,this.mesh.materialsByIndex[e].mapDiffuse.texture):this.mesh.materialsByIndex[e].mapDiffuse.texture.addEventListener("load",()=>{this.loadTexture(t,e,this.mesh.materialsByIndex[e].mapDiffuse.texture)}),!0)}loadTexture(t,e,r,i=!0){let n=t.createTexture();return t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,n),i&&t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!0),t.texImage2D(t.TEXTURE_2D,0,t.RGB,t.RGB,t.UNSIGNED_BYTE,r),t.generateMipmap(t.TEXTURE_2D),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),this.textures[e]=n,n}setTexture(t,e){this.textures[e]=t}draw(t){this.activateBuffers(t),this.textures.forEach((e,r)=>{let i=this.mesh.vertexBuffer.itemSize,n=this.mesh.submesh[r];this.activateMaterial(t,r);t.drawElements(t.TRIANGLES,i*n.numItems,t.UNSIGNED_SHORT,n.offset*i*2)}),t.bindVertexArray(null)}activateBuffers(t){t.bindVertexArray(this.VAO),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.mesh.indexBuffer)}drawActivatedMaterial(t,e){let r=this.mesh.vertexBuffer.itemSize,i=this.mesh.submesh[e];t.drawElements(t.TRIANGLES,r*i.numItems,t.UNSIGNED_SHORT,i.offset*r*2)}activateMaterial(t,e){this.mesh.materialsByIndex[e].isTextureActive[0]&&this.mesh.materialsByIndex[e].mapTransparency.texture_id&&(t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.mesh.materialsByIndex[e].mapTransparency.texture_id)),this.mesh.materialsByIndex[e].isTextureActive[1]&&this.mesh.materialsByIndex[e].mapEmissive.texture_id&&(t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this.mesh.materialsByIndex[e].mapEmissive.texture_id)),this.mesh.materialsByIndex[e].isTextureActive[2]&&this.mesh.materialsByIndex[e].mapAmbient.texture_id&&(t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,this.mesh.materialsByIndex[e].mapAmbient.texture_id)),this.mesh.materialsByIndex[e].isTextureActive[3]&&this.mesh.materialsByIndex[e].mapDiffuse.texture_id&&(t.activeTexture(t.TEXTURE3),t.bindTexture(t.TEXTURE_2D,this.mesh.materialsByIndex[e].mapDiffuse.texture_id)),this.mesh.materialsByIndex[e].isTextureActive[4]&&this.mesh.materialsByIndex[e].mapSpecular.texture_id&&(t.activeTexture(t.TEXTURE4),t.bindTexture(t.TEXTURE_2D,this.mesh.materialsByIndex[e].mapSpecular.texture_id)),this.mesh.materialsByIndex[e].isTextureActive[5]&&this.mesh.materialsByIndex[e].mapSpecularExponent.texture_id&&(t.activeTexture(t.TEXTURE5),t.bindTexture(t.TEXTURE_2D,this.mesh.materialsByIndex[e].mapSpecularExponent.texture_id)),a.shader.setFloat(a.shader.uniforms.material_transparency,this.mesh.materialsByIndex[e].transparency),a.shader.setVec3(a.shader.uniforms.material_ambient_colour,this.mesh.materialsByIndex[e].ambient),a.shader.setVec3(a.shader.uniforms.material_diffuse_colour,this.mesh.materialsByIndex[e].diffuse),a.shader.setVec3(a.shader.uniforms.material_specular_colour,this.mesh.materialsByIndex[e].specular),a.shader.setVec3(a.shader.uniforms.material_emissive_colour,this.mesh.materialsByIndex[e].emissive),a.shader.setFloat(a.shader.uniforms.material_shininess,this.mesh.materialsByIndex[e].specularExponent),a.shader.setIntV(a.shader.uniforms.material_is_texture_active,this.mesh.materialsByIndex[e].isTextureActive)}}e.BasicModel=a},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(13),n=r(14),a=r(5),s=r(26);r.d(e,"Mesh",function(){return i.a}),r.d(e,"Material",function(){return n.a}),r.d(e,"MaterialLibrary",function(){return n.b}),r.d(e,"Layout",function(){return a.a}),r.d(e,"downloadModels",function(){return s.c}),r.d(e,"downloadMeshes",function(){return s.b}),r.d(e,"initMeshBuffers",function(){return s.e}),r.d(e,"deleteMeshBuffers",function(){return s.a}),r.d(e,"downloadMtlTextures",function(){return s.d})},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(0),n=r(27);!function(t){t[t.BASIC=0]="BASIC",t[t.MESHLESS=1]="MESHLESS"}(e.Model_Type||(e.Model_Type={}));e.Entity=class{constructor(t,e,r,a=i.vec3.fromValues(0,0,-1),s=i.vec3.fromValues(1,1,1)){this.id=n.Guid.newGuid(),this.position=i.vec3.clone(r),this.scalar=i.vec3.clone(s),this.forward=i.vec3.clone(a),this.mesh_name=t,this.model_type=e}}},function(t,e,r){"use strict";class i{constructor(...t){this.attributes=t;let e=0,r=0;for(const i of t){if(this[i.key])throw new n(i);e%i.sizeOfType!=0&&(e+=i.sizeOfType-e%i.sizeOfType,console.warn("Layout requires padding before "+i.key+" attribute")),this[i.key]={attribute:i,size:i.size,type:i.type,normalized:i.normalized,offset:e},e+=i.sizeInBytes,r=Math.max(r,i.sizeOfType)}e%r!=0&&(e+=r-e%r,console.warn("Layout requires padding at the back")),this.stride=e;for(const e of t)this[e.key].stride=this.stride}}e.a=i;class n{constructor(t){this.message="found duplicate attribute: "+t.key}}class a{constructor(t,e,r,i=!1){this.key=t,this.size=e,this.type=r,this.normalized=!1,this.sizeOfType=function(t){switch(t){case"BYTE":case"UNSIGNED_BYTE":return 1;case"SHORT":case"UNSIGNED_SHORT":return 2;case"FLOAT":return 4}}(r),this.sizeInBytes=this.sizeOfType*e}}i.POSITION=new a("position",3,"FLOAT"),i.NORMAL=new a("normal",3,"FLOAT"),i.TANGENT=new a("tangent",3,"FLOAT"),i.BITANGENT=new a("bitangent",3,"FLOAT"),i.UV=new a("uv",2,"FLOAT"),i.MATERIAL_INDEX=new a("materialIndex",1,"SHORT"),i.MATERIAL_ENABLED=new a("materialEnabled",1,"UNSIGNED_SHORT"),i.AMBIENT=new a("ambient",3,"FLOAT"),i.DIFFUSE=new a("diffuse",3,"FLOAT"),i.SPECULAR=new a("specular",3,"FLOAT"),i.SPECULAR_EXPONENT=new a("specularExponent",3,"FLOAT"),i.EMISSIVE=new a("emissive",3,"FLOAT"),i.TRANSMISSION_FILTER=new a("transmissionFilter",3,"FLOAT"),i.DISSOLVE=new a("dissolve",1,"FLOAT"),i.ILLUMINATION=new a("illumination",1,"UNSIGNED_SHORT"),i.REFRACTION_INDEX=new a("refractionIndex",1,"FLOAT"),i.SHARPNESS=new a("sharpness",1,"FLOAT"),i.MAP_DIFFUSE=new a("mapDiffuse",1,"SHORT"),i.MAP_AMBIENT=new a("mapAmbient",1,"SHORT"),i.MAP_SPECULAR=new a("mapSpecular",1,"SHORT"),i.MAP_SPECULAR_EXPONENT=new a("mapSpecularExponent",1,"SHORT"),i.MAP_DISSOLVE=new a("mapDissolve",1,"SHORT"),i.ANTI_ALIASING=new a("antiAliasing",1,"UNSIGNED_SHORT"),i.MAP_BUMP=new a("mapBump",1,"SHORT"),i.MAP_DISPLACEMENT=new a("mapDisplacement",1,"SHORT"),i.MAP_DECAL=new a("mapDecal",1,"SHORT"),i.MAP_EMISSIVE=new a("mapEmissive",1,"SHORT")},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){function e(t,e,r,i,n,a){let s=t-i,o=e-n;return s*s+o*o<=(r+a)*(r+a)}t.circleIntersection=e,t.pointCircleIntersection=function(t,r,i,n,a){return e(t,r,0,i,n,a)},t.cylinderIntersection=function(t,r,i,n,a,s){let o=i,l=s;return!(t[1]+o<n[1]-l||t[1]-o>n[1]+l)&&e(t[0],t[2],r,n[0],n[2],a)}}(e.Collision||(e.Collision={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){let t=new i.ARRAY_TYPE(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(t){let e=new i.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromValues=function(t,e,r,n,a,s,o,l,u){let c=new i.ARRAY_TYPE(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=n,c[4]=a,c[5]=s,c[6]=o,c[7]=l,c[8]=u,c},e.set=function(t,e,r,i,n,a,s,o,l,u){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=a,t[5]=s,t[6]=o,t[7]=l,t[8]=u,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,e){if(t===e){let r=e[1],i=e[2],n=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=i,t[7]=n}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},e.invert=function(t,e){let r=e[0],i=e[1],n=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=c*s-o*u,d=-c*a+o*l,m=u*a-s*l,f=r*h+i*d+n*m;if(!f)return null;return f=1/f,t[0]=h*f,t[1]=(-c*i+n*u)*f,t[2]=(o*i-n*s)*f,t[3]=d*f,t[4]=(c*r-n*l)*f,t[5]=(-o*r+n*a)*f,t[6]=m*f,t[7]=(-u*r+i*l)*f,t[8]=(s*r-i*a)*f,t},e.adjoint=function(t,e){let r=e[0],i=e[1],n=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8];return t[0]=s*c-o*u,t[1]=n*u-i*c,t[2]=i*o-n*s,t[3]=o*l-a*c,t[4]=r*c-n*l,t[5]=n*a-r*o,t[6]=a*u-s*l,t[7]=i*l-r*u,t[8]=r*s-i*a,t},e.determinant=function(t){let e=t[0],r=t[1],i=t[2],n=t[3],a=t[4],s=t[5],o=t[6],l=t[7],u=t[8];return e*(u*a-s*l)+r*(-u*n+s*o)+i*(l*n-a*o)},e.multiply=n,e.translate=function(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=r[0],m=r[1];return t[0]=i,t[1]=n,t[2]=a,t[3]=s,t[4]=o,t[5]=l,t[6]=d*i+m*s+u,t[7]=d*n+m*o+c,t[8]=d*a+m*l+h,t},e.rotate=function(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=Math.sin(r),m=Math.cos(r);return t[0]=m*i+d*s,t[1]=m*n+d*o,t[2]=m*a+d*l,t[3]=m*s-d*i,t[4]=m*o-d*n,t[5]=m*l-d*a,t[6]=u,t[7]=c,t[8]=h,t},e.scale=function(t,e,r){let i=r[0],n=r[1];return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=n*e[3],t[4]=n*e[4],t[5]=n*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.fromRotation=function(t,e){let r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=-r,t[4]=i,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(t,e){let r=e[0],i=e[1],n=e[2],a=e[3],s=r+r,o=i+i,l=n+n,u=r*s,c=i*s,h=i*o,d=n*s,m=n*o,f=n*l,p=a*s,M=a*o,_=a*l;return t[0]=1-h-f,t[3]=c-_,t[6]=d+M,t[1]=c+_,t[4]=1-u-f,t[7]=m-p,t[2]=d-M,t[5]=m+p,t[8]=1-u-h,t},e.normalFromMat4=function(t,e){let r=e[0],i=e[1],n=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],m=e[11],f=e[12],p=e[13],M=e[14],_=e[15],x=r*o-i*s,b=r*l-n*s,v=r*u-a*s,y=i*l-n*o,g=i*u-a*o,E=n*u-a*l,w=c*p-h*f,T=c*M-d*f,R=c*_-m*f,A=h*M-d*p,S=h*_-m*p,I=d*_-m*M,D=x*I-b*S+v*A+y*R-g*T+E*w;if(!D)return null;return D=1/D,t[0]=(o*I-l*S+u*A)*D,t[1]=(l*R-s*I-u*T)*D,t[2]=(s*S-o*R+u*w)*D,t[3]=(n*S-i*I-a*A)*D,t[4]=(r*I-n*R+a*T)*D,t[5]=(i*R-r*S-a*w)*D,t[6]=(p*E-M*g+_*y)*D,t[7]=(M*v-f*E-_*b)*D,t[8]=(f*g-p*v+_*x)*D,t},e.projection=function(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},e.str=function(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t},e.subtract=a,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t},e.multiplyScalarAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},e.equals=function(t,e){let r=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=e[0],m=e[1],f=e[2],p=e[3],M=e[4],_=e[5],x=e[6],b=e[7],v=e[8];return Math.abs(r-d)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(d))&&Math.abs(n-m)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(a-f)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(s-p)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(o-M)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(M))&&Math.abs(l-_)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(_))&&Math.abs(u-x)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(x))&&Math.abs(c-b)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(h-v)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(v))};var i=r(1);function n(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=r[0],m=r[1],f=r[2],p=r[3],M=r[4],_=r[5],x=r[6],b=r[7],v=r[8];return t[0]=d*i+m*s+f*u,t[1]=d*n+m*o+f*c,t[2]=d*a+m*l+f*h,t[3]=p*i+M*s+_*u,t[4]=p*n+M*o+_*c,t[5]=p*a+M*l+_*h,t[6]=x*i+b*s+v*u,t[7]=x*n+b*o+v*c,t[8]=x*a+b*l+v*h,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}const s=n;e.mul=s;const o=a;e.sub=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){let t=new i.ARRAY_TYPE(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.clone=function(t){let e=new i.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.fromValues=function(t,e,r,n,a,s,o,l,u,c,h,d,m,f,p,M){let _=new i.ARRAY_TYPE(16);return _[0]=t,_[1]=e,_[2]=r,_[3]=n,_[4]=a,_[5]=s,_[6]=o,_[7]=l,_[8]=u,_[9]=c,_[10]=h,_[11]=d,_[12]=m,_[13]=f,_[14]=p,_[15]=M,_},e.set=function(t,e,r,i,n,a,s,o,l,u,c,h,d,m,f,p,M){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=a,t[5]=s,t[6]=o,t[7]=l,t[8]=u,t[9]=c,t[10]=h,t[11]=d,t[12]=m,t[13]=f,t[14]=p,t[15]=M,t},e.identity=n,e.transpose=function(t,e){if(t===e){let r=e[1],i=e[2],n=e[3],a=e[6],s=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=i,t[9]=a,t[11]=e[14],t[12]=n,t[13]=s,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},e.invert=function(t,e){let r=e[0],i=e[1],n=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],m=e[11],f=e[12],p=e[13],M=e[14],_=e[15],x=r*o-i*s,b=r*l-n*s,v=r*u-a*s,y=i*l-n*o,g=i*u-a*o,E=n*u-a*l,w=c*p-h*f,T=c*M-d*f,R=c*_-m*f,A=h*M-d*p,S=h*_-m*p,I=d*_-m*M,D=x*I-b*S+v*A+y*R-g*T+E*w;if(!D)return null;return D=1/D,t[0]=(o*I-l*S+u*A)*D,t[1]=(n*S-i*I-a*A)*D,t[2]=(p*E-M*g+_*y)*D,t[3]=(d*g-h*E-m*y)*D,t[4]=(l*R-s*I-u*T)*D,t[5]=(r*I-n*R+a*T)*D,t[6]=(M*v-f*E-_*b)*D,t[7]=(c*E-d*v+m*b)*D,t[8]=(s*S-o*R+u*w)*D,t[9]=(i*R-r*S-a*w)*D,t[10]=(f*g-p*v+_*x)*D,t[11]=(h*v-c*g-m*x)*D,t[12]=(o*T-s*A-l*w)*D,t[13]=(r*A-i*T+n*w)*D,t[14]=(p*b-f*y-M*x)*D,t[15]=(c*y-h*b+d*x)*D,t},e.adjoint=function(t,e){let r=e[0],i=e[1],n=e[2],a=e[3],s=e[4],o=e[5],l=e[6],u=e[7],c=e[8],h=e[9],d=e[10],m=e[11],f=e[12],p=e[13],M=e[14],_=e[15];return t[0]=o*(d*_-m*M)-h*(l*_-u*M)+p*(l*m-u*d),t[1]=-(i*(d*_-m*M)-h*(n*_-a*M)+p*(n*m-a*d)),t[2]=i*(l*_-u*M)-o*(n*_-a*M)+p*(n*u-a*l),t[3]=-(i*(l*m-u*d)-o*(n*m-a*d)+h*(n*u-a*l)),t[4]=-(s*(d*_-m*M)-c*(l*_-u*M)+f*(l*m-u*d)),t[5]=r*(d*_-m*M)-c*(n*_-a*M)+f*(n*m-a*d),t[6]=-(r*(l*_-u*M)-s*(n*_-a*M)+f*(n*u-a*l)),t[7]=r*(l*m-u*d)-s*(n*m-a*d)+c*(n*u-a*l),t[8]=s*(h*_-m*p)-c*(o*_-u*p)+f*(o*m-u*h),t[9]=-(r*(h*_-m*p)-c*(i*_-a*p)+f*(i*m-a*h)),t[10]=r*(o*_-u*p)-s*(i*_-a*p)+f*(i*u-a*o),t[11]=-(r*(o*m-u*h)-s*(i*m-a*h)+c*(i*u-a*o)),t[12]=-(s*(h*M-d*p)-c*(o*M-l*p)+f*(o*d-l*h)),t[13]=r*(h*M-d*p)-c*(i*M-n*p)+f*(i*d-n*h),t[14]=-(r*(o*M-l*p)-s*(i*M-n*p)+f*(i*l-n*o)),t[15]=r*(o*d-l*h)-s*(i*d-n*h)+c*(i*l-n*o),t},e.determinant=function(t){let e=t[0],r=t[1],i=t[2],n=t[3],a=t[4],s=t[5],o=t[6],l=t[7],u=t[8],c=t[9],h=t[10],d=t[11],m=t[12],f=t[13],p=t[14],M=t[15];return(e*s-r*a)*(h*M-d*p)-(e*o-i*a)*(c*M-d*f)+(e*l-n*a)*(c*p-h*f)+(r*o-i*s)*(u*M-d*m)-(r*l-n*s)*(u*p-h*m)+(i*l-n*o)*(u*f-c*m)},e.multiply=a,e.translate=function(t,e,r){let i,n,a,s,o,l,u,c,h,d,m,f,p=r[0],M=r[1],_=r[2];e===t?(t[12]=e[0]*p+e[4]*M+e[8]*_+e[12],t[13]=e[1]*p+e[5]*M+e[9]*_+e[13],t[14]=e[2]*p+e[6]*M+e[10]*_+e[14],t[15]=e[3]*p+e[7]*M+e[11]*_+e[15]):(i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],m=e[10],f=e[11],t[0]=i,t[1]=n,t[2]=a,t[3]=s,t[4]=o,t[5]=l,t[6]=u,t[7]=c,t[8]=h,t[9]=d,t[10]=m,t[11]=f,t[12]=i*p+o*M+h*_+e[12],t[13]=n*p+l*M+d*_+e[13],t[14]=a*p+u*M+m*_+e[14],t[15]=s*p+c*M+f*_+e[15]);return t},e.scale=function(t,e,r){let i=r[0],n=r[1],a=r[2];return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,r,n){let a,s,o,l,u,c,h,d,m,f,p,M,_,x,b,v,y,g,E,w,T,R,A,S,I=n[0],D=n[1],B=n[2],P=Math.sqrt(I*I+D*D+B*B);if(Math.abs(P)<i.EPSILON)return null;I*=P=1/P,D*=P,B*=P,a=Math.sin(r),s=Math.cos(r),o=1-s,l=e[0],u=e[1],c=e[2],h=e[3],d=e[4],m=e[5],f=e[6],p=e[7],M=e[8],_=e[9],x=e[10],b=e[11],v=I*I*o+s,y=D*I*o+B*a,g=B*I*o-D*a,E=I*D*o-B*a,w=D*D*o+s,T=B*D*o+I*a,R=I*B*o+D*a,A=D*B*o-I*a,S=B*B*o+s,t[0]=l*v+d*y+M*g,t[1]=u*v+m*y+_*g,t[2]=c*v+f*y+x*g,t[3]=h*v+p*y+b*g,t[4]=l*E+d*w+M*T,t[5]=u*E+m*w+_*T,t[6]=c*E+f*w+x*T,t[7]=h*E+p*w+b*T,t[8]=l*R+d*A+M*S,t[9]=u*R+m*A+_*S,t[10]=c*R+f*A+x*S,t[11]=h*R+p*A+b*S,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t},e.rotateX=function(t,e,r){let i=Math.sin(r),n=Math.cos(r),a=e[4],s=e[5],o=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[4]=a*n+u*i,t[5]=s*n+c*i,t[6]=o*n+h*i,t[7]=l*n+d*i,t[8]=u*n-a*i,t[9]=c*n-s*i,t[10]=h*n-o*i,t[11]=d*n-l*i,t},e.rotateY=function(t,e,r){let i=Math.sin(r),n=Math.cos(r),a=e[0],s=e[1],o=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=a*n-u*i,t[1]=s*n-c*i,t[2]=o*n-h*i,t[3]=l*n-d*i,t[8]=a*i+u*n,t[9]=s*i+c*n,t[10]=o*i+h*n,t[11]=l*i+d*n,t},e.rotateZ=function(t,e,r){let i=Math.sin(r),n=Math.cos(r),a=e[0],s=e[1],o=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]);return t[0]=a*n+u*i,t[1]=s*n+c*i,t[2]=o*n+h*i,t[3]=l*n+d*i,t[4]=u*n-a*i,t[5]=c*n-s*i,t[6]=h*n-o*i,t[7]=d*n-l*i,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,r){let n,a,s,o=r[0],l=r[1],u=r[2],c=Math.sqrt(o*o+l*l+u*u);if(Math.abs(c)<i.EPSILON)return null;return o*=c=1/c,l*=c,u*=c,n=Math.sin(e),a=Math.cos(e),s=1-a,t[0]=o*o*s+a,t[1]=l*o*s+u*n,t[2]=u*o*s-l*n,t[3]=0,t[4]=o*l*s-u*n,t[5]=l*l*s+a,t[6]=u*l*s+o*n,t[7]=0,t[8]=o*u*s+l*n,t[9]=l*u*s-o*n,t[10]=u*u*s+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromXRotation=function(t,e){let r=Math.sin(e),i=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=i,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){let r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){let r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=i,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=s,e.fromQuat2=function(t,e){let r=new i.ARRAY_TYPE(3),n=-e[0],a=-e[1],o=-e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7],m=n*n+a*a+o*o+l*l;m>0?(r[0]=2*(u*l+d*n+c*o-h*a)/m,r[1]=2*(c*l+d*a+h*n-u*o)/m,r[2]=2*(h*l+d*o+u*a-c*n)/m):(r[0]=2*(u*l+d*n+c*o-h*a),r[1]=2*(c*l+d*a+h*n-u*o),r[2]=2*(h*l+d*o+u*a-c*n));return s(t,e,r),t},e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){let r=e[0],i=e[1],n=e[2],a=e[4],s=e[5],o=e[6],l=e[8],u=e[9],c=e[10];return t[0]=Math.sqrt(r*r+i*i+n*n),t[1]=Math.sqrt(a*a+s*s+o*o),t[2]=Math.sqrt(l*l+u*u+c*c),t},e.getRotation=function(t,e){let r=e[0]+e[5]+e[10],i=0;r>0?(i=2*Math.sqrt(r+1),t[3]=.25*i,t[0]=(e[6]-e[9])/i,t[1]=(e[8]-e[2])/i,t[2]=(e[1]-e[4])/i):e[0]>e[5]&&e[0]>e[10]?(i=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/i,t[0]=.25*i,t[1]=(e[1]+e[4])/i,t[2]=(e[8]+e[2])/i):e[5]>e[10]?(i=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/i,t[0]=(e[1]+e[4])/i,t[1]=.25*i,t[2]=(e[6]+e[9])/i):(i=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/i,t[0]=(e[8]+e[2])/i,t[1]=(e[6]+e[9])/i,t[2]=.25*i);return t},e.fromRotationTranslationScale=function(t,e,r,i){let n=e[0],a=e[1],s=e[2],o=e[3],l=n+n,u=a+a,c=s+s,h=n*l,d=n*u,m=n*c,f=a*u,p=a*c,M=s*c,_=o*l,x=o*u,b=o*c,v=i[0],y=i[1],g=i[2];return t[0]=(1-(f+M))*v,t[1]=(d+b)*v,t[2]=(m-x)*v,t[3]=0,t[4]=(d-b)*y,t[5]=(1-(h+M))*y,t[6]=(p+_)*y,t[7]=0,t[8]=(m+x)*g,t[9]=(p-_)*g,t[10]=(1-(h+f))*g,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,r,i,n){let a=e[0],s=e[1],o=e[2],l=e[3],u=a+a,c=s+s,h=o+o,d=a*u,m=a*c,f=a*h,p=s*c,M=s*h,_=o*h,x=l*u,b=l*c,v=l*h,y=i[0],g=i[1],E=i[2],w=n[0],T=n[1],R=n[2],A=(1-(p+_))*y,S=(m+v)*y,I=(f-b)*y,D=(m-v)*g,B=(1-(d+_))*g,P=(M+x)*g,L=(f+b)*E,k=(M-x)*E,O=(1-(d+p))*E;return t[0]=A,t[1]=S,t[2]=I,t[3]=0,t[4]=D,t[5]=B,t[6]=P,t[7]=0,t[8]=L,t[9]=k,t[10]=O,t[11]=0,t[12]=r[0]+w-(A*w+D*T+L*R),t[13]=r[1]+T-(S*w+B*T+k*R),t[14]=r[2]+R-(I*w+P*T+O*R),t[15]=1,t},e.fromQuat=function(t,e){let r=e[0],i=e[1],n=e[2],a=e[3],s=r+r,o=i+i,l=n+n,u=r*s,c=i*s,h=i*o,d=n*s,m=n*o,f=n*l,p=a*s,M=a*o,_=a*l;return t[0]=1-h-f,t[1]=c+_,t[2]=d-M,t[3]=0,t[4]=c-_,t[5]=1-u-f,t[6]=m+p,t[7]=0,t[8]=d+M,t[9]=m-p,t[10]=1-u-h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,r,i,n,a,s){let o=1/(r-e),l=1/(n-i),u=1/(a-s);return t[0]=2*a*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*l,t[6]=0,t[7]=0,t[8]=(r+e)*o,t[9]=(n+i)*l,t[10]=(s+a)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*a*2*u,t[15]=0,t},e.perspective=function(t,e,r,i,n){let a=1/Math.tan(e/2),s=1/(i-n);return t[0]=a/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(n+i)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*n*i*s,t[15]=0,t},e.perspectiveFromFieldOfView=function(t,e,r,i){let n=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),l=2/(s+o),u=2/(n+a);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-(s-o)*l*.5,t[9]=(n-a)*u*.5,t[10]=i/(r-i),t[11]=-1,t[12]=0,t[13]=0,t[14]=i*r/(r-i),t[15]=0,t},e.ortho=function(t,e,r,i,n,a,s){let o=1/(e-r),l=1/(i-n),u=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+r)*o,t[13]=(n+i)*l,t[14]=(s+a)*u,t[15]=1,t},e.lookAt=function(t,e,r,a){let s,o,l,u,c,h,d,m,f,p,M=e[0],_=e[1],x=e[2],b=a[0],v=a[1],y=a[2],g=r[0],E=r[1],w=r[2];if(Math.abs(M-g)<i.EPSILON&&Math.abs(_-E)<i.EPSILON&&Math.abs(x-w)<i.EPSILON)return n(t);d=M-g,m=_-E,f=x-w,p=1/Math.sqrt(d*d+m*m+f*f),s=v*(f*=p)-y*(m*=p),o=y*(d*=p)-b*f,l=b*m-v*d,(p=Math.sqrt(s*s+o*o+l*l))?(s*=p=1/p,o*=p,l*=p):(s=0,o=0,l=0);u=m*l-f*o,c=f*s-d*l,h=d*o-m*s,(p=Math.sqrt(u*u+c*c+h*h))?(u*=p=1/p,c*=p,h*=p):(u=0,c=0,h=0);return t[0]=s,t[1]=u,t[2]=d,t[3]=0,t[4]=o,t[5]=c,t[6]=m,t[7]=0,t[8]=l,t[9]=h,t[10]=f,t[11]=0,t[12]=-(s*M+o*_+l*x),t[13]=-(u*M+c*_+h*x),t[14]=-(d*M+m*_+f*x),t[15]=1,t},e.targetTo=function(t,e,r,i){let n=e[0],a=e[1],s=e[2],o=i[0],l=i[1],u=i[2],c=n-r[0],h=a-r[1],d=s-r[2],m=c*c+h*h+d*d;m>0&&(m=1/Math.sqrt(m),c*=m,h*=m,d*=m);let f=l*d-u*h,p=u*c-o*d,M=o*h-l*c;(m=f*f+p*p+M*M)>0&&(m=1/Math.sqrt(m),f*=m,p*=m,M*=m);return t[0]=f,t[1]=p,t[2]=M,t[3]=0,t[4]=h*M-d*p,t[5]=d*f-c*M,t[6]=c*p-h*f,t[7]=0,t[8]=c,t[9]=h,t[10]=d,t[11]=0,t[12]=n,t[13]=a,t[14]=s,t[15]=1,t},e.str=function(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t},e.subtract=o,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t},e.multiplyScalarAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t[6]=e[6]+r[6]*i,t[7]=e[7]+r[7]*i,t[8]=e[8]+r[8]*i,t[9]=e[9]+r[9]*i,t[10]=e[10]+r[10]*i,t[11]=e[11]+r[11]*i,t[12]=e[12]+r[12]*i,t[13]=e[13]+r[13]*i,t[14]=e[14]+r[14]*i,t[15]=e[15]+r[15]*i,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){let r=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],u=t[6],c=t[7],h=t[8],d=t[9],m=t[10],f=t[11],p=t[12],M=t[13],_=t[14],x=t[15],b=e[0],v=e[1],y=e[2],g=e[3],E=e[4],w=e[5],T=e[6],R=e[7],A=e[8],S=e[9],I=e[10],D=e[11],B=e[12],P=e[13],L=e[14],k=e[15];return Math.abs(r-b)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-v)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(v))&&Math.abs(a-y)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(s-g)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(g))&&Math.abs(o-E)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(E))&&Math.abs(l-w)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(w))&&Math.abs(u-T)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(T))&&Math.abs(c-R)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(R))&&Math.abs(h-A)<=i.EPSILON*Math.max(1,Math.abs(h),Math.abs(A))&&Math.abs(d-S)<=i.EPSILON*Math.max(1,Math.abs(d),Math.abs(S))&&Math.abs(m-I)<=i.EPSILON*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(f-D)<=i.EPSILON*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(p-B)<=i.EPSILON*Math.max(1,Math.abs(p),Math.abs(B))&&Math.abs(M-P)<=i.EPSILON*Math.max(1,Math.abs(M),Math.abs(P))&&Math.abs(_-L)<=i.EPSILON*Math.max(1,Math.abs(_),Math.abs(L))&&Math.abs(x-k)<=i.EPSILON*Math.max(1,Math.abs(x),Math.abs(k))};var i=r(1);function n(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function a(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],m=e[10],f=e[11],p=e[12],M=e[13],_=e[14],x=e[15],b=r[0],v=r[1],y=r[2],g=r[3];return t[0]=b*i+v*o+y*h+g*p,t[1]=b*n+v*l+y*d+g*M,t[2]=b*a+v*u+y*m+g*_,t[3]=b*s+v*c+y*f+g*x,b=r[4],v=r[5],y=r[6],g=r[7],t[4]=b*i+v*o+y*h+g*p,t[5]=b*n+v*l+y*d+g*M,t[6]=b*a+v*u+y*m+g*_,t[7]=b*s+v*c+y*f+g*x,b=r[8],v=r[9],y=r[10],g=r[11],t[8]=b*i+v*o+y*h+g*p,t[9]=b*n+v*l+y*d+g*M,t[10]=b*a+v*u+y*m+g*_,t[11]=b*s+v*c+y*f+g*x,b=r[12],v=r[13],y=r[14],g=r[15],t[12]=b*i+v*o+y*h+g*p,t[13]=b*n+v*l+y*d+g*M,t[14]=b*a+v*u+y*m+g*_,t[15]=b*s+v*c+y*f+g*x,t}function s(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=i+i,l=n+n,u=a+a,c=i*o,h=i*l,d=i*u,m=n*l,f=n*u,p=a*u,M=s*o,_=s*l,x=s*u;return t[0]=1-(m+p),t[1]=h+x,t[2]=d-_,t[3]=0,t[4]=h-x,t[5]=1-(c+p),t[6]=f+M,t[7]=0,t[8]=d+_,t[9]=f-M,t[10]=1-(c+m),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function o(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}const l=a;e.mul=l;const u=o;e.sub=u},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=o,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},e.setAxisAngle=l,e.getAxisAngle=function(t,e){let r=2*Math.acos(e[3]),i=Math.sin(r/2);0!=i?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0);return r},e.multiply=u,e.rotateX=function(t,e,r){r*=.5;let i=e[0],n=e[1],a=e[2],s=e[3],o=Math.sin(r),l=Math.cos(r);return t[0]=i*l+s*o,t[1]=n*l+a*o,t[2]=a*l-n*o,t[3]=s*l-i*o,t},e.rotateY=function(t,e,r){r*=.5;let i=e[0],n=e[1],a=e[2],s=e[3],o=Math.sin(r),l=Math.cos(r);return t[0]=i*l-a*o,t[1]=n*l+s*o,t[2]=a*l+i*o,t[3]=s*l-n*o,t},e.rotateZ=function(t,e,r){r*=.5;let i=e[0],n=e[1],a=e[2],s=e[3],o=Math.sin(r),l=Math.cos(r);return t[0]=i*l+n*o,t[1]=n*l-i*o,t[2]=a*l+s*o,t[3]=s*l-a*o,t},e.calculateW=function(t,e){let r=e[0],i=e[1],n=e[2];return t[0]=r,t[1]=i,t[2]=n,t[3]=Math.sqrt(Math.abs(1-r*r-i*i-n*n)),t},e.slerp=c,e.invert=function(t,e){let r=e[0],i=e[1],n=e[2],a=e[3],s=r*r+i*i+n*n+a*a,o=s?1/s:0;return t[0]=-r*o,t[1]=-i*o,t[2]=-n*o,t[3]=a*o,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},e.fromMat3=h,e.fromEuler=function(t,e,r,i){let n=.5*Math.PI/180;e*=n,r*=n,i*=n;let a=Math.sin(e),s=Math.cos(e),o=Math.sin(r),l=Math.cos(r),u=Math.sin(i),c=Math.cos(i);return t[0]=a*l*c-s*o*u,t[1]=s*o*c+a*l*u,t[2]=s*l*u-a*o*c,t[3]=s*l*c+a*o*u,t},e.str=function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"};var i=r(1),n=r(7),a=r(10),s=r(11);function o(){let t=new i.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function l(t,e,r){r*=.5;let i=Math.sin(r);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(r),t}function u(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=r[0],l=r[1],u=r[2],c=r[3];return t[0]=i*c+s*o+n*u-a*l,t[1]=n*c+s*l+a*o-i*u,t[2]=a*c+s*u+i*l-n*o,t[3]=s*c-i*o-n*l-a*u,t}function c(t,e,r,i){let n,a,s,o,l,u=e[0],c=e[1],h=e[2],d=e[3],m=r[0],f=r[1],p=r[2],M=r[3];return(a=u*m+c*f+h*p+d*M)<0&&(a=-a,m=-m,f=-f,p=-p,M=-M),1-a>1e-6?(n=Math.acos(a),s=Math.sin(n),o=Math.sin((1-i)*n)/s,l=Math.sin(i*n)/s):(o=1-i,l=i),t[0]=o*u+l*m,t[1]=o*c+l*f,t[2]=o*h+l*p,t[3]=o*d+l*M,t}function h(t,e){let r,i=e[0]+e[4]+e[8];if(i>0)r=Math.sqrt(i+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);let n=(i+1)%3,a=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*n+n]-e[3*a+a]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*n+a]-e[3*a+n])*r,t[n]=(e[3*n+i]+e[3*i+n])*r,t[a]=(e[3*a+i]+e[3*i+a])*r}return t}const d=s.clone;e.clone=d;const m=s.fromValues;e.fromValues=m;const f=s.copy;e.copy=f;const p=s.set;e.set=p;const M=s.add;e.add=M;const _=u;e.mul=_;const x=s.scale;e.scale=x;const b=s.dot;e.dot=b;const v=s.lerp;e.lerp=v;const y=s.length;e.length=y;const g=y;e.len=g;const E=s.squaredLength;e.squaredLength=E;const w=E;e.sqrLen=w;const T=s.normalize;e.normalize=T;const R=s.exactEquals;e.exactEquals=R;const A=s.equals;e.equals=A;const S=function(){let t=a.create(),e=a.fromValues(1,0,0),r=a.fromValues(0,1,0);return function(i,n,s){let o=a.dot(n,s);return o<-.999999?(a.cross(t,e,n),a.len(t)<1e-6&&a.cross(t,r,n),a.normalize(t,t),l(i,t,Math.PI),i):o>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(a.cross(t,n,s),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+o,T(i,i))}}();e.rotationTo=S;const I=function(){let t=o(),e=o();return function(r,i,n,a,s,o){return c(t,i,s,o),c(e,n,a,o),c(r,t,e,2*o*(1-o)),r}}();e.sqlerp=I;const D=function(){let t=n.create();return function(e,r,i,n){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=n[0],t[4]=n[1],t[7]=n[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],T(e,h(e,t))}}();e.setAxes=D},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=n,e.clone=function(t){var e=new i.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.length=a,e.fromValues=s,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(t,e,r,i){return t[0]=e,t[1]=r,t[2]=i,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t},e.subtract=o,e.multiply=l,e.divide=u,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t},e.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t},e.distance=c,e.squaredDistance=h,e.squaredLength=d,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=m,e.dot=f,e.cross=function(t,e,r){let i=e[0],n=e[1],a=e[2],s=r[0],o=r[1],l=r[2];return t[0]=n*l-a*o,t[1]=a*s-i*l,t[2]=i*o-n*s,t},e.lerp=function(t,e,r,i){let n=e[0],a=e[1],s=e[2];return t[0]=n+i*(r[0]-n),t[1]=a+i*(r[1]-a),t[2]=s+i*(r[2]-s),t},e.hermite=function(t,e,r,i,n,a){let s=a*a,o=s*(2*a-3)+1,l=s*(a-2)+a,u=s*(a-1),c=s*(3-2*a);return t[0]=e[0]*o+r[0]*l+i[0]*u+n[0]*c,t[1]=e[1]*o+r[1]*l+i[1]*u+n[1]*c,t[2]=e[2]*o+r[2]*l+i[2]*u+n[2]*c,t},e.bezier=function(t,e,r,i,n,a){let s=1-a,o=s*s,l=a*a,u=o*s,c=3*a*o,h=3*l*s,d=l*a;return t[0]=e[0]*u+r[0]*c+i[0]*h+n[0]*d,t[1]=e[1]*u+r[1]*c+i[1]*h+n[1]*d,t[2]=e[2]*u+r[2]*c+i[2]*h+n[2]*d,t},e.random=function(t,e){e=e||1;let r=2*i.RANDOM()*Math.PI,n=2*i.RANDOM()-1,a=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*a,t[1]=Math.sin(r)*a,t[2]=n*e,t},e.transformMat4=function(t,e,r){let i=e[0],n=e[1],a=e[2],s=r[3]*i+r[7]*n+r[11]*a+r[15];return s=s||1,t[0]=(r[0]*i+r[4]*n+r[8]*a+r[12])/s,t[1]=(r[1]*i+r[5]*n+r[9]*a+r[13])/s,t[2]=(r[2]*i+r[6]*n+r[10]*a+r[14])/s,t},e.transformMat3=function(t,e,r){let i=e[0],n=e[1],a=e[2];return t[0]=i*r[0]+n*r[3]+a*r[6],t[1]=i*r[1]+n*r[4]+a*r[7],t[2]=i*r[2]+n*r[5]+a*r[8],t},e.transformQuat=function(t,e,r){let i=r[0],n=r[1],a=r[2],s=r[3],o=e[0],l=e[1],u=e[2],c=n*u-a*l,h=a*o-i*u,d=i*l-n*o,m=n*d-a*h,f=a*c-i*d,p=i*h-n*c,M=2*s;return c*=M,h*=M,d*=M,m*=2,f*=2,p*=2,t[0]=o+c+m,t[1]=l+h+f,t[2]=u+d+p,t},e.rotateX=function(t,e,r,i){let n=[],a=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],a[0]=n[0],a[1]=n[1]*Math.cos(i)-n[2]*Math.sin(i),a[2]=n[1]*Math.sin(i)+n[2]*Math.cos(i),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},e.rotateY=function(t,e,r,i){let n=[],a=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],a[0]=n[2]*Math.sin(i)+n[0]*Math.cos(i),a[1]=n[1],a[2]=n[2]*Math.cos(i)-n[0]*Math.sin(i),t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},e.rotateZ=function(t,e,r,i){let n=[],a=[];return n[0]=e[0]-r[0],n[1]=e[1]-r[1],n[2]=e[2]-r[2],a[0]=n[0]*Math.cos(i)-n[1]*Math.sin(i),a[1]=n[0]*Math.sin(i)+n[1]*Math.cos(i),a[2]=n[2],t[0]=a[0]+r[0],t[1]=a[1]+r[1],t[2]=a[2]+r[2],t},e.angle=function(t,e){let r=s(t[0],t[1],t[2]),i=s(e[0],e[1],e[2]);m(r,r),m(i,i);let n=f(r,i);return n>1?0:n<-1?Math.PI:Math.acos(n)},e.str=function(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},e.equals=function(t,e){let r=t[0],n=t[1],a=t[2],s=e[0],o=e[1],l=e[2];return Math.abs(r-s)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-o)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(a-l)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(l))};var i=r(1);function n(){let t=new i.ARRAY_TYPE(3);return t[0]=0,t[1]=0,t[2]=0,t}function a(t){let e=t[0],r=t[1],i=t[2];return Math.sqrt(e*e+r*r+i*i)}function s(t,e,r){let n=new i.ARRAY_TYPE(3);return n[0]=t,n[1]=e,n[2]=r,n}function o(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function l(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function u(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function c(t,e){let r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return Math.sqrt(r*r+i*i+n*n)}function h(t,e){let r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2];return r*r+i*i+n*n}function d(t){let e=t[0],r=t[1],i=t[2];return e*e+r*r+i*i}function m(t,e){let r=e[0],i=e[1],n=e[2],a=r*r+i*i+n*n;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a),t}function f(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}const p=o;e.sub=p;const M=l;e.mul=M;const _=u;e.div=_;const x=c;e.dist=x;const b=h;e.sqrDist=b;const v=a;e.len=v;const y=d;e.sqrLen=y;const g=function(){let t=n();return function(e,r,i,n,a,s){let o,l;for(r||(r=3),i||(i=0),l=n?Math.min(n*r+i,e.length):e.length,o=i;o<l;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2];return e}}();e.forEach=g},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=n,e.clone=function(t){let e=new i.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.fromValues=function(t,e,r,n){let a=new i.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(t,e,r,i,n){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},e.subtract=a,e.multiply=s,e.divide=o,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},e.scale=l,e.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t},e.distance=u,e.squaredDistance=c,e.length=h,e.squaredLength=d,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=m,e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},e.lerp=function(t,e,r,i){let n=e[0],a=e[1],s=e[2],o=e[3];return t[0]=n+i*(r[0]-n),t[1]=a+i*(r[1]-a),t[2]=s+i*(r[2]-s),t[3]=o+i*(r[3]-o),t},e.random=function(t,e){return e=e||1,t[0]=i.RANDOM(),t[1]=i.RANDOM(),t[2]=i.RANDOM(),t[3]=i.RANDOM(),m(t,t),l(t,t,e),t},e.transformMat4=function(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3];return t[0]=r[0]*i+r[4]*n+r[8]*a+r[12]*s,t[1]=r[1]*i+r[5]*n+r[9]*a+r[13]*s,t[2]=r[2]*i+r[6]*n+r[10]*a+r[14]*s,t[3]=r[3]*i+r[7]*n+r[11]*a+r[15]*s,t},e.transformQuat=function(t,e,r){let i=e[0],n=e[1],a=e[2],s=r[0],o=r[1],l=r[2],u=r[3],c=u*i+o*a-l*n,h=u*n+l*i-s*a,d=u*a+s*n-o*i,m=-s*i-o*n-l*a;return t[0]=c*u+m*-s+h*-l-d*-o,t[1]=h*u+m*-o+d*-s-c*-l,t[2]=d*u+m*-l+c*-o-h*-s,t[3]=e[3],t},e.str=function(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){let r=t[0],n=t[1],a=t[2],s=t[3],o=e[0],l=e[1],u=e[2],c=e[3];return Math.abs(r-o)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-l)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-u)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(s-c)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(c))};var i=r(1);function n(){let t=new i.ARRAY_TYPE(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function s(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function o(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function l(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function u(t,e){let r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2],a=e[3]-t[3];return Math.sqrt(r*r+i*i+n*n+a*a)}function c(t,e){let r=e[0]-t[0],i=e[1]-t[1],n=e[2]-t[2],a=e[3]-t[3];return r*r+i*i+n*n+a*a}function h(t){let e=t[0],r=t[1],i=t[2],n=t[3];return Math.sqrt(e*e+r*r+i*i+n*n)}function d(t){let e=t[0],r=t[1],i=t[2],n=t[3];return e*e+r*r+i*i+n*n}function m(t,e){let r=e[0],i=e[1],n=e[2],a=e[3],s=r*r+i*i+n*n+a*a;return s>0&&(s=1/Math.sqrt(s),t[0]=r*s,t[1]=i*s,t[2]=n*s,t[3]=a*s),t}const f=a;e.sub=f;const p=s;e.mul=p;const M=o;e.div=M;const _=u;e.dist=_;const x=c;e.sqrDist=x;const b=h;e.len=b;const v=d;e.sqrLen=v;const y=function(){let t=n();return function(e,r,i,n,a,s){let o,l;for(r||(r=4),i||(i=0),l=n?Math.min(n*r+i,e.length):e.length,o=i;o<l;o+=r)t[0]=e[o],t[1]=e[o+1],t[2]=e[o+2],t[3]=e[o+3],a(t,t,s),e[o]=t[0],e[o+1]=t[1],e[o+2]=t[2],e[o+3]=t[3];return e}}();e.forEach=y},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});function i(t,e,r){let i;return i=t.createShader(r),t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS)?i:(alert(t.getShaderInfoLog(i)),null)}e.Shader=class{constructor(t,e,r){this.gl=t;let n=i(t,e,t.VERTEX_SHADER),a=i(t,r,t.FRAGMENT_SHADER);this.ID=t.createProgram(),t.attachShader(this.ID,n),t.attachShader(this.ID,a),t.linkProgram(this.ID),t.getProgramParameter(this.ID,t.LINK_STATUS)||alert("Could not initialize shaders")}use(){this.gl.useProgram(this.ID)}setBoolByName(t,e){this.gl.uniform1i(this.getUniformLocation(t),e?1:0)}setBool(t,e){this.gl.uniform1i(t,e?1:0)}setInt(t,e){this.gl.uniform1i(t,e)}setIntByName(t,e){this.gl.uniform1i(this.getUniformLocation(t),e)}setIntV(t,e){this.gl.uniform1iv(t,e)}setIntVByName(t,e){this.gl.uniform1iv(this.getUniformLocation(t),e)}setFloat(t,e){this.gl.uniform1f(t,e)}setFloatByName(t,e){this.gl.uniform1f(this.getUniformLocation(t),e)}getUniformLocation(t){return this.gl.getUniformLocation(this.ID,t)}setMat4(t,e){this.gl.uniformMatrix4fv(t,!1,e)}setMat4ByName(t,e){this.gl.uniformMatrix4fv(this.getUniformLocation(t),!1,e)}setVec3(t,e){this.gl.uniform3fv(t,e)}setVec3ByName(t,e){this.gl.uniform3fv(this.getUniformLocation(t),e)}setVec4(t,e){this.gl.uniform4fv(t,e)}setVec4ByName(t,e){this.gl.uniform4fv(this.getUniformLocation(t),e)}}},function(t,e,r){"use strict";var i=r(5);e.a=class{constructor(t,e){(e=e||{}).materials=e.materials||[],this.has_materials=!!e.materials,this.materials={},this.submesh={},this.vertices=[],this.vertexNormals=[],this.textures=[],this.indices=[],this.name="";const r=[],i=[],n=[],a={},s=[],o={};let l=-1;a.verts=[],a.norms=[],a.textures=[],a.hashindices={},a.indices=[],a.materialIndices=[],a.index=0;let u=[],c=0,h=0;const d=/^v\s/,m=/^vn\s/,f=/^vt\s/,p=/^f\s/,M=/\s+/,_=/^usemtl/,x=t.split("\n");for(let t=0;t<x.length;t++){const e=x[t].trim();if(!e||e.startsWith("#"))continue;const b=e.split(M);if(b.shift(),d.test(e))r.push(...b);else if(m.test(e))i.push(...b);else if(f.test(e))n.push(b[0]),n.push(b[1]);else if(_.test(e)){const t=b[0];t in o||(0!==c&&u.push({offset:h,numItems:c}),h+=c,c=0,s.push(t),o[t]=s.length-1),l=o[t]}else if(p.test(e)){c++;let t=!1;for(let e=0,s=b.length;e<s;e++){3!==e||t||(e=2,t=!0,c++);const s=b[0]+","+l,o=b[e]+","+l;if(o in a.hashindices)a.indices.push(a.hashindices[o]);else{let t=b[e].split("/"),s=t.length-1;a.verts.push(+r[3*(t[0]-1)+0]),a.verts.push(+r[3*(t[0]-1)+1]),a.verts.push(+r[3*(t[0]-1)+2]),n.length&&(a.textures.push(+n[2*(t[1]-1)+0]),a.textures.push(+n[2*(t[1]-1)+1])),a.norms.push(+i[3*(t[s]-1)+0]),a.norms.push(+i[3*(t[s]-1)+1]),a.norms.push(+i[3*(t[s]-1)+2]),a.materialIndices.push(l),a.hashindices[o]=a.index,a.indices.push(a.index),a.index+=1}3===e&&t&&a.indices.push(a.hashindices[s])}}}u.push({offset:h,numItems:c}),this.vertices=a.verts,this.vertexNormals=a.norms,this.textures=a.textures,this.vertexMaterialIndices=a.materialIndices,this.indices=a.indices,this.submesh=u,this.materialNames=s,this.materialIndices=o,this.materialsByIndex={}}makeBufferData(t){const e=this.vertices.length/3,r=new ArrayBuffer(t.stride*e);r.numItems=e;const n=new DataView(r);for(let r=0,a=0;r<e;r++){a=r*t.stride;for(const e of t.attributes){const s=a+t[e.key].offset;switch(e.key){case i.a.POSITION.key:n.setFloat32(s,this.vertices[3*r],!0),n.setFloat32(s+4,this.vertices[3*r+1],!0),n.setFloat32(s+8,this.vertices[3*r+2],!0);break;case i.a.UV.key:n.setFloat32(s,this.textures[2*r],!0),n.setFloat32(s+4,this.vertices[2*r+1],!0);break;case i.a.NORMAL.key:n.setFloat32(s,this.vertexNormals[3*r],!0),n.setFloat32(s+4,this.vertexNormals[3*r+1],!0),n.setFloat32(s+8,this.vertexNormals[3*r+2],!0);break;case i.a.MATERIAL_INDEX.key:n.setInt16(s,this.vertexMaterialIndices[r],!0);break;case i.a.AMBIENT.key:{const t=this.vertexMaterialIndices[r],e=this.materialsByIndex[t];if(!e){console.warn('Material "'+this.materialNames[t]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}n.setFloat32(s,e.ambient[0],!0),n.setFloat32(s+4,e.ambient[1],!0),n.setFloat32(s+8,e.ambient[2],!0);break}case i.a.DIFFUSE.key:{const t=this.vertexMaterialIndices[r],e=this.materialsByIndex[t];if(!e){console.warn('Material "'+this.materialNames[t]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}n.setFloat32(s,e.diffuse[0],!0),n.setFloat32(s+4,e.diffuse[1],!0),n.setFloat32(s+8,e.diffuse[2],!0);break}case i.a.SPECULAR.key:{const t=this.vertexMaterialIndices[r],e=this.materialsByIndex[t];if(!e){console.warn('Material "'+this.materialNames[t]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}n.setFloat32(s,e.specular[0],!0),n.setFloat32(s+4,e.specular[1],!0),n.setFloat32(s+8,e.specular[2],!0);break}case i.a.SPECULAR_EXPONENT.key:{const t=this.vertexMaterialIndices[r],e=this.materialsByIndex[t];if(!e){console.warn('Material "'+this.materialNames[t]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}n.setFloat32(s,e.specularExponent,!0);break}case i.a.EMISSIVE.key:{const t=this.vertexMaterialIndices[r],e=this.materialsByIndex[t];if(!e){console.warn('Material "'+this.materialNames[t]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}n.setFloat32(s,e.emissive[0],!0),n.setFloat32(s+4,e.emissive[1],!0),n.setFloat32(s+8,e.emissive[2],!0);break}case i.a.TRANSMISSION_FILTER.key:{const t=this.vertexMaterialIndices[r],e=this.materialsByIndex[t];if(!e){console.warn('Material "'+this.materialNames[t]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}n.setFloat32(s,e.transmissionFilter[0],!0),n.setFloat32(s+4,e.transmissionFilter[1],!0),n.setFloat32(s+8,e.transmissionFilter[2],!0);break}case i.a.DISSOLVE.key:{const t=this.vertexMaterialIndices[r],e=this.materialsByIndex[t];if(!e){console.warn('Material "'+this.materialNames[t]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}n.setFloat32(s,e.dissolve,!0);break}case i.a.ILLUMINATION.key:{const t=this.vertexMaterialIndices[r],e=this.materialsByIndex[t];if(!e){console.warn('Material "'+this.materialNames[t]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}n.setInt16(s,e.illumination,!0);break}case i.a.REFRACTION_INDEX.key:{const t=this.vertexMaterialIndices[r],e=this.materialsByIndex[t];if(!e){console.warn('Material "'+this.materialNames[t]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}n.setFloat32(s,e.refractionIndex,!0);break}case i.a.SHARPNESS.key:{const t=this.vertexMaterialIndices[r],e=this.materialsByIndex[t];if(!e){console.warn('Material "'+this.materialNames[t]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}n.setFloat32(s,e.sharpness,!0);break}case i.a.ANTI_ALIASING.key:{const t=this.vertexMaterialIndices[r],e=this.materialsByIndex[t];if(!e){console.warn('Material "'+this.materialNames[t]+'" not found in mesh. Did you forget to call addMaterialLibrary(...)?"');break}n.setInt16(s,e.antiAliasing,!0);break}}}}return r}makeIndexBufferData(){const t=new Uint16Array(this.indices);return t.numItems=this.indices.length,t}addMaterialLibrary(t){for(const e in t.materials){if(!(e in this.materialIndices))continue;const r=t.materials[e],i=this.materialIndices[r.name];this.materials[e]=r,this.materialsByIndex[i]=r}}}},function(t,e,r){"use strict";const i=0,n=.2,a=.8,s=0,o=20,l=1,u=1,c=2;class h{constructor(t){this.name=t,this.illumination=c,this.ambient=[n,n,n],this.mapAmbient=null,this.diffuse=[a,a,a],this.mapDiffuse=null,this.transparency=1,this.mapTransparency=null,this.specular=[s,s,s],this.mapSpecular=null,this.mapSpecularExponent=null,this.specularExponent=o,this.emissive=[i,i,i],this.mapEmissive=null,this.transmissionFilter=[u,u,u],this.dissolve=0,this.mapDissolve=null,this.refractionIndex=l,this.sharpness=0,this.antiAliasing=!1,this.mapBump=null,this.mapDisplacement=null,this.mapDecal=null,this.mapReflections=[],this.isTextureActive=new Array(6),this.textureIds=[]}updateActiveTextures(){null!=this.mapTransparency?this.isTextureActive[0]=!0:this.isTextureActive[0]=!1,null!=this.mapEmissive?this.isTextureActive[1]=!0:this.isTextureActive[1]=!1,null!=this.mapAmbient?this.isTextureActive[2]=!0:this.isTextureActive[2]=!1,null!=this.mapDiffuse?this.isTextureActive[3]=!0:this.isTextureActive[3]=!1,null!=this.mapSpecular?this.isTextureActive[4]=!0:this.isTextureActive[4]=!1,null!=this.mapSpecularExponent?this.isTextureActive[5]=!0:this.isTextureActive[5]=!1}}e.a=h;e.b=class{constructor(t){for(var e in this.data=t,this.currentMaterial=null,this.materials={},this.parse(),this.materials)this.materials[e].updateActiveTextures()}parse_newmtl(t){let e=t[0];this.currentMaterial=new h(e),this.materials[e]=this.currentMaterial}parseColor(t){if("spectral"==t[0])return void console.error("The MTL parser does not support spectral curve files. You will need to convert the MTL colors to either RGB or CIEXYZ.");if("xyz"==t[0])return void console.warn("TODO: convert XYZ to RGB");if(3==t.length)return t.map(parseFloat);let e=parseFloat(t[0]);return[e,e,e]}parse_Ka(t){this.currentMaterial.ambient=this.parseColor(t)}parse_Kd(t){this.currentMaterial.diffuse=this.parseColor(t)}parse_Ks(t){this.currentMaterial.specular=this.parseColor(t)}parse_Ke(t){this.currentMaterial.emissive=this.parseColor(t)}parse_Tf(t){this.currentMaterial.transmissionFilter=this.parseColor(t)}parse_d(t){this.currentMaterial.transparency=1-parseFloat(t.pop())}parse_Tr(t){this.currentMaterial.transparency=parseFloat(t.pop())}parse_illum(t){this.currentMaterial.illumination=parseInt(t[0])}parse_Ni(t){this.currentMaterial.refractionIndex=parseFloat(t[0])}parse_Ns(t){this.currentMaterial.specularExponent=parseInt(t[0])}parse_sharpness(t){this.currentMaterial.sharpness=parseInt(t[0])}parse_cc(t,e){e.colorCorrection="on"==t[0]}parse_blendu(t,e){e.horizontalBlending="on"==t[0]}parse_blendv(t,e){e.verticalBlending="on"==t[0]}parse_boost(t,e){e.boostMipMapSharpness=parseFloat(t[0])}parse_mm(t,e){e.modifyTextureMap.brightness=parseFloat(t[0]),e.modifyTextureMap.contrast=parseFloat(t[1])}parse_ost(t,e,r){for(;t.length<3;)t.push(r);e.u=parseFloat(t[0]),e.v=parseFloat(t[1]),e.w=parseFloat(t[2])}parse_o(t,e){this.parse_ost(t,e.offset,0)}parse_s(t,e){this.parse_ost(t,e.scale,1)}parse_t(t,e){this.parse_ost(t,e.turbulence,0)}parse_texres(t,e){e.textureResolution=parseFloat(t[0])}parse_clamp(t,e){e.clamp="on"==t[0]}parse_bm(t,e){e.bumpMultiplier=parseFloat(t[0])}parse_imfchan(t,e){e.imfChan=t[0]}parse_type(t,e){e.reflectionType=t[0]}parseOptions(t){let e,r,i={colorCorrection:!1,horizontalBlending:!0,verticalBlending:!0,boostMipMapSharpness:0,modifyTextureMap:{brightness:0,contrast:1},offset:{u:0,v:0,w:0},scale:{u:1,v:1,w:1},turbulence:{u:0,v:0,w:0},clamp:!1,textureResolution:null,bumpMultiplier:1,imfChan:null},n={};for(t.reverse();t.length;){const r=t.pop();r.startsWith("-")?n[e=r.substr(1)]=[]:n[e].push(r)}for(e in n){if(!n.hasOwnProperty(e))continue;r=n[e];let t=this[`parse_${e}`];t&&t.bind(this)(r,i)}return i}parseMap(t){let e,r;return t[0].startsWith("-")?(e=t.pop(),r=t):[e,...r]=t,(r=this.parseOptions(r)).filename=e,r}parse_map_Ka(t){this.currentMaterial.mapAmbient=this.parseMap(t)}parse_map_Kd(t){this.currentMaterial.mapDiffuse=this.parseMap(t)}parse_map_Ks(t){this.currentMaterial.mapSpecular=this.parseMap(t)}parse_map_Ke(t){this.currentMaterial.mapEmissive=this.parseMap(t)}parse_map_Ns(t){this.currentMaterial.mapSpecularExponent=this.parseMap(t)}parse_map_d(t){this.currentMaterial.mapTransparency=this.parseMap(t)}parse_map_Tr(t){this.currentMaterial.mapTransparency=this.parseMap(t)}parse_map_aat(t){this.currentMaterial.antiAliasing="on"==t[0]}parse_map_bump(t){this.currentMaterial.mapBump=this.parseMap(t)}parse_bump(t){this.parse_map_bump(t)}parse_disp(t){this.currentMaterial.mapDisplacement=this.parseMap(t)}parse_decal(t){this.currentMaterial.mapDecal=this.parseMap(t)}parse_refl(t){this.currentMaterial.mapReflections.push(this.parseMap(t))}parse(){let t=this.data.split(/\r?\n/);for(let e of t){if(!(e=e.trim())||e.startsWith("#"))continue;let t,r=e.split(/\s/);[t,...r]=r;let i=this[`parse_${t}`];i?i.bind(this)(r):console.warn(`Don't know how to parse the directive: "${t}"`)}delete this.data,this.currentMaterial=null}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(0),n=r(2),a=r(29),s=r(30),o=r(4),l=r(31),u=r(16);var c;!function(t){t[t.RED_ROCK=0]="RED_ROCK",t[t.LEAFY=1]="LEAFY",t[t.ICY=2]="ICY",t[t.SANDY=3]="SANDY",t[t.GREY_ROCK=4]="GREY_ROCK"}(c=e.Terrain||(e.Terrain={}));class h extends o.Entity{constructor(t,e,r,n,a,s){if(super(t.mesh.name,o.Model_Type.BASIC,i.vec3.fromValues(n,a,s),i.vec3.fromValues(0,0,0),i.vec3.fromValues(r,1,r)),!t.initialized)throw"DiskModel was not initialized";this.diskModel=t,this.radius=r,this.type=e,this.initialized=!1}init(t){this.generateHeightMapModels(t),this.heightMapModel.init(t);let e=this.radius*Math.SQRT2/2,r=i.vec3.fromValues(2*e/this.heightMapSize,1,2*e/this.heightMapSize),n=i.vec3.fromValues(this.position[0],this.position[1]+1e-4,this.position[2]);this.heightMapEntity=new o.Entity(this.heightMapModel.name,o.Model_Type.MESHLESS,n,this.forward,r),h.height_map_model_gen_count++,this.initialized=!0}generateHeightMapModels(t){switch(this.type){case c.RED_ROCK:this.heightMapSize=16,this.initRedRockHeightMap();break;case c.LEAFY:this.heightMapSize=32,this.initLeafyHeightMap();break;case c.ICY:this.heightMapSize=48,this.initIcyHeightMap();break;case c.SANDY:this.heightMapSize=64,this.initSandyHeightMap();break;case c.GREY_ROCK:this.heightMapSize=80,this.initGreyRockHeightMap()}this.generateHeightMapModel(t)}generateHeightMapModel(t){let e=(this.heightMapSize+1)*(this.heightMapSize+1),r=new Float32Array(8*e),i=0;for(let t=0;t<this.heightMapSize+1;t++)for(let e=0;e<this.heightMapSize+1;e++)r[i++]=t-this.heightMapSize/2,r[i++]=this.heightMap[t][e],r[i++]=e-this.heightMapSize/2,r[i++]=t/16,r[i++]=e/16,r[i++]=0,r[i++]=0,r[i++]=0;let n=this.heightMapSize*this.heightMapSize*6,s=new Uint16Array(n);i=0;for(let t=0;t<e-(this.heightMapSize+1);t+=this.heightMapSize+1)for(let e=0;e<this.heightMapSize;e++){const r=t+e;s[i++]=r+(this.heightMapSize+1),s[i++]=r,s[i++]=r+(this.heightMapSize+1)+1,s[i++]=r+(this.heightMapSize+1)+1,s[i++]=r,s[i++]=r+1}for(let t=0;t<n-2;t+=3){const e=8*s[t],i=8*s[t+1],n=8*s[t+2];let a=new Array(3);const o=r[i]-r[e],l=r[i+1]-r[e+1],u=r[i+2]-r[e+2],c=r[n]-r[e],h=r[n+1]-r[e+1],d=r[n+2]-r[e+2];a[0]=l*d-u*h,a[1]=u*c-o*d,a[2]=o*h-l*c,r[e+5]+=a[0],r[e+6]+=a[1],r[e+7]+=a[2],r[i+5]+=a[0],r[i+6]+=a[1],r[i+7]+=a[2],r[n+5]+=a[0],r[n+6]+=a[1],r[n+7]+=a[2]}this.heightMapModel=new a.MeshlessModel(r,s,this.diskModel.mesh.materialsByIndex[2])}initRedRockHeightMap(){this.heightMap=[];let t=[];t.push(0,0);for(let e=2;e<=this.heightMapSize/2;e++){let r=t[e-1];t.push(Math.round(10*(r+3*Math.random()-1))/10)}for(let e=0;e<=this.heightMapSize;e++){this.heightMap[e]=[];let r=e>this.heightMapSize/2?this.heightMapSize-e:e;for(let i=0;i<=this.heightMapSize;i++){i>this.heightMapSize-r&&r--;let n=i;n>r&&(n=r),this.heightMap[e].push(t[n])}}}initSandyHeightMap(){this.heightMap=[];let t=new s.Noisefield(16,8,u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295)),e=new Array(this.heightMapSize+1),r=1-Math.pow(.5,6);for(let t=0;t<=this.heightMapSize;t++){let r=t/this.heightMapSize;e[t]=Math.max(Math.pow(r,6),Math.pow(1-r,6))}for(let i=0;i<=this.heightMapSize;i++){this.heightMap[i]=[];for(let n=0;n<=this.heightMapSize;n++){let a=t.perlineNoise(n,i),s=(1-Math.max(e[i],e[n]))/r;this.heightMap[i].push(a*s)}}}initGreyRockHeightMap(){this.heightMap=[];let t=[new s.Noisefield(32,1,u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295)),new s.Noisefield(16,7,u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295)),new s.Noisefield(8,5,u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295)),new s.Noisefield(4,3.5,u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295)),new s.Noisefield(2,2.5,u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295),u.Random.randi(4294967295))];for(let e=0;e<=this.heightMapSize;e++){this.heightMap[e]=[];for(let r=0;r<=this.heightMapSize;r++){let i=t[0].perlineNoise(r,e)+t[1].perlineNoise(r,e)+t[2].perlineNoise(r,e)+t[3].perlineNoise(r,e)+t[4].perlineNoise(r,e),n=e/this.heightMapSize,a=r/this.heightMapSize,s=(1-Math.max(Math.max(Math.pow(n,6),Math.pow(1-n,6)),Math.max(Math.pow(a,6),Math.pow(1-a,6))))/(1-Math.pow(.5,6));this.heightMap[e].push(i*s)}}}initIcyHeightMap(){let t=[],e=this.heightMapSize/2;for(let r=0;r<200;r++){let r=Math.random()*e,i=Math.random()*e,n=Math.random()*e,a=Math.random()*e,s=Math.max(r,i,n,a),o=Math.random()*Math.PI*2,l=e+Math.cos(o)*s,u=e+Math.sin(o)*s,c=.7*(e-s),h=Math.random()*(c+c)-c;t.push([l,h,u])}this.heightMap=new Array(this.heightMapSize+1);for(let e=0;e<=this.heightMapSize;e++){this.heightMap[e]=new Array(this.heightMapSize+1);for(let r=0;r<=this.heightMapSize;r++){let i=0,n=0;for(let a=0;a<t.length;a++){let s=(t[a][0]-e)*(t[a][0]-e),o=(t[a][2]-r)*(t[a][2]-r),l=Math.sqrt(s+o);n=Math.max(n,t[a][1]-l),i=Math.min(i,t[a][1]+l)}this.heightMap[e][r]=n+i}}}initLeafyHeightMap(){let t=2*Math.random()-1,e=2*Math.random()-1,r=2*Math.random()-1,i=2*Math.random()-1,n=2*Math.random()-1,a=2*Math.random()-1,s=u.Random.randi(7),o=u.Random.randi(7),l=s<o?s:o,c=Math.random()*(2*Math.PI),h=Math.random(),d=Math.random(),m=Math.random();Math.random()>.5&&(h=-h,d=-d,m=-m),this.heightMap=new Array(this.heightMapSize+1);for(let s=0;s<=this.heightMapSize;s++){this.heightMap[s]=new Array(this.heightMapSize+1);for(let o=0;o<=this.heightMapSize;o++){let u=s/this.heightMapSize,f=2*u-1,p=2*(o/this.heightMapSize)-1,M=Math.min(Math.sqrt(f*f+p*p),1),_=Math.atan2(p,f),x=Math.pow(u,4)*(1-u)*12*t+.5*(Math.cos(Math.PI*f)+1)*e+Math.pow(1-u,4)*u*12*r,b=Math.pow(Math.max(1-M,0),2)*i+Math.sin(Math.PI*Math.min(Math.pow(M,.8)*(4/3),1))*n+Math.max(Math.sin(Math.PI*Math.pow(M,1.6)),0)*a,v=4*(Math.sqrt(M)-M)*h+Math.pow(M,2)*Math.pow(1-M,2)*16*d+4*(Math.sqrt(1-M)-(1-M))*m,y=x*b,g=_*l+c,E=.5*(Math.sin(g)+1)*v;this.heightMap[s][o]=5*y+3*E}}}draw(t,e,r){this.drawDiskModel(t,e,r),this.drawHeightMapModel(t,e,r)}drawDiskModel(t,e,r){let a=i.mat4.create(),s=i.vec3.fromValues(this.position[0],this.position[1],this.position[2]);i.mat4.translate(a,a,s),i.mat4.scale(a,a,i.vec3.fromValues(this.radius,1,this.radius)),n.BasicModel.setMVPMatrices(a,e,r),this.diskModel.draw(t)}drawHeightMapModel(t,e,r){let a=i.mat4.create(),s=i.vec3.fromValues(this.position[0],this.position[1],this.position[2]),o=this.radius*Math.SQRT2/2;s[1]+=1e-5,i.mat4.translate(a,a,s),i.mat4.scale(a,a,i.vec3.fromValues(2*o/this.heightMapSize,1,2*o/this.heightMapSize)),n.BasicModel.setMVPMatrices(a,e,r),this.heightMapModel.draw(t)}getSpeedFactor(){switch(this.type){case c.RED_ROCK:return 1;case c.LEAFY:return.5;case c.ICY:return.25;case c.SANDY:return.75;case c.GREY_ROCK:return 1}return 1}getHeightAtPosition(t,e){let r=(t-this.position[0])*(this.heightMapSize/2)/(this.radius*Math.SQRT1_2)+this.heightMapSize/2,n=(e-this.position[2])*(this.heightMapSize/2)/(this.radius*Math.SQRT1_2)+this.heightMapSize/2;if(r>this.heightMapSize||r<0||n>this.heightMapSize||n<0)return 0;let a,s=Math.floor(r),o=Math.floor(n),u=r-s,c=n-o,h=i.vec3.create(),d=i.vec3.fromValues(s,this.heightMap[s][o],o),m=i.vec3.fromValues(s+1,this.heightMap[s+1][o+1],o+1);u>c?i.vec3.set(h,s+1,this.heightMap[s+1][o],o):i.vec3.set(h,s,this.heightMap[s][o+1],o+1);let f=i.vec2.fromValues(r,n),p=i.vec2.fromValues(h[0],h[2]),M=i.vec2.fromValues(d[0],d[2]),_=i.vec2.fromValues(m[0],m[2]),x=l.MathHelper.barycentric(f,p,M,_);return a=x[0]*h[1]+x[1]*d[1]+x[2]*m[1]}}h.height_map_model_gen_count=0,e.Disk=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t){t.randi=function(t){return Math.floor(Math.random()*Math.floor(t))}}(e.Random||(e.Random={}))},function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},function(t,e,r){"use strict";var i=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))(function(n,a){function s(t){try{l(i.next(t))}catch(t){a(t)}}function o(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){t.done?n(t.value):new r(function(e){e(t.value)}).then(s,o)}l((i=i.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const n=r(0),a=r(12),s=r(23),o=r(24),l=r(28),u=r(38),c=r(2),h=r(40),d=r(41),m=r(42);let f,p,M,_,x,b,v=r(47),y=window.document;const g=n.vec3.fromValues(0,.8,0),E=n.vec3.fromValues(1,0,0),w=n.vec3.fromValues(0,o.Player.half_height,0);let T=[],R=[],A=0,S=0,I=y.getElementById("fpscounter"),D=y.getElementById("score"),B=new s.Camera(n.vec3.fromValues(0,1.6,0),n.vec3.fromValues(0,1,0),0),P=new s.Camera(n.vec3.fromValues(100,200,10),n.vec3.fromValues(0,1,0),0,0);P.lookAt(n.vec3.fromValues(0,0,0));let L=B;window.onkeydown=function(t){T[t.keyCode]=!0},window.onkeyup=function(t){T[t.keyCode]=!1},window.onmousedown=function(t){R[t.which]=!0},window.onmouseup=function(t){R[t.which]=!1},new class{constructor(){this.fullscreenChange=(t=>{let e=window.document,r=p;e.webkitFullscreenElement!==p&&e.mozFullscreenElement!==p&&e.mozFullScreenElement!==p&&e.fullscreenElement!==p||(p.requestPointerLock=p.requestPointerLock||r.mozRequestPointerLock||r.webkitRequestPointerLock,p.requestPointerLock())}),this.pointerLockChange=(t=>{let e=window.document;e.pointerLockElement===p||e.mozPointerLockElement===p||e.webkitPointerLockElement===p?e.addEventListener("mousemove",this.moveCallback,!1):e.removeEventListener("mousemove",this.moveCallback,!1)}),this.moveCallback=(t=>{let e=t.movementX||t.mozMovementX||t.webkitMovementX||0,r=t.movementY||t.mozMovementY||t.webkitMovementY||0;A+=e,S+=r}),p=y.getElementById("canvas"),this.initGL(),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(f=!0),M.clearColor(.2,.3,.3,1),M.enable(M.DEPTH_TEST),M.enable(M.CULL_FACE),M.cullFace(M.BACK),this.resize(),M.clear(M.COLOR_BUFFER_BIT|M.DEPTH_BUFFER_BIT),this.loadAssets().then(()=>{this.initBuffers(),this.initPointerLock(),setTimeout(t=>{v.setBegin(this.begin.bind(this)).setUpdate(this.update.bind(this)).setDraw(this.draw.bind(this)).setEnd(this.end.bind(this)).start()},100)})}loadAssets(){return i(this,void 0,void 0,function*(){let t=Date.now(),e=y.getElementById("loading");e.innerText="Loading Models and World. Please Wait.";let i=yield l.World.loadWorldMeshes(),n=yield l.World.loadWorldMat(),s=yield l.World.loadWorldData(),c=yield l.World.loadPickupMeshes(),f=yield u.Skybox.load(),p=yield o.Player.loadMesh();this.player=new o.Player(M,p.cbabe,g),this.skybox=new u.Skybox(M,f.Skybox);let v=Date.now();this.world=new l.World(M,s,i,n,c),console.log("world gen time: "+(Date.now()-v)/1e3+"s"),_=yield new a.Shader(M,r(48),r(49)),x=yield new d.BasicModelShader(M,r(50),r(51)),(b=new h.Renderer).init(x),b.addBasicModel(this.player.model),b.addEntityToRenderList(this.player),b.addBasicModel(this.world.diskAModel),b.addBasicModel(this.world.diskBModel),b.addBasicModel(this.world.diskCModel),b.addBasicModel(this.world.diskDModel),b.addBasicModel(this.world.diskEModel),b.addBasicModel(this.world.ring_model),b.addBasicModel(this.world.rod_model),this.world.disks.forEach(t=>{m(t.initialized),b.addEntityToRenderList(t),b.addMeshlessModel(t.heightMapModel),b.addEntityToRenderList(t.heightMapEntity)}),this.world.pickup_manager.rings.forEach(t=>{b.addEntityToRenderList(t)}),this.world.pickup_manager.rods.forEach(t=>{b.addEntityToRenderList(t)}),e.remove();let E=Date.now();console.log("total time: "+(E-t)/1e3+"s")})}initGL(){try{M=p.getContext("webgl2")}catch(t){throw"GL init error:\n"+t}M||alert("WebGL is not available on your browser."),M.enable(M.SAMPLE_COVERAGE),M.sampleCoverage(1,!1)}initBuffers(){B.front=this.player.forward,_.use(),_.setIntByName("texture1",0),x.use(),c.BasicModel.initWithShader(M,x)}update(t){t/=1e3,T[40]||T[83]?this.player.move(o.Player_Movement.BACKWARD,t):(T[38]||T[87]||R[1]&&R[3])&&this.player.move(o.Player_Movement.FORWARD,t),T[65]?this.player.move(o.Player_Movement.LEFT,t):T[68]&&this.player.move(o.Player_Movement.RIGHT,t),T[37]&&this.player.rotate(t),T[39]&&this.player.rotate(-t),T[82]&&(n.vec3.copy(this.player.position,g),n.vec3.copy(this.player.forward,E)),L=T[79]?P:B,this.player.rotate(-A/600),B.processMouseMovement(this.player.forward,this.player.position,A,-S,!0),A=0,S=0;let e=this.world.getHeightAtCirclePosition(this.player.position[0],this.player.position[2],o.Player.radius);this.player.position[1]=e+o.Player.half_height,this.world.update(t),this.world.pickup_manager.checkForPickupsCylinderIntersection(this.player.position,o.Player.radius,o.Player.half_height,b),B.front[0]=this.player.forward[0],B.front[2]=this.player.forward[2],B.up=this.player.up;let r=n.vec3.clone(this.player.position);r[0]-=2*this.player.forward[0],r[2]-=2*this.player.forward[2],n.vec3.add(r,r,w),n.vec3.copy(B.position,r)}begin(t,e){e/=1e3,f&&this.doDemo(e)}draw(t){this.resize(),M.clear(M.COLOR_BUFFER_BIT|M.DEPTH_BUFFER_BIT);let e=n.mat4.create();n.mat4.identity(e);let r=L.getViewMatrix();n.mat4.perspective(e,n.glMatrix.toRadian(80),p.clientWidth/p.clientHeight,.1,2e3);let i=n.mat4.create();M.disable(M.DEPTH_TEST),_.use(),n.mat4.translate(i,i,L.position),_.setFloatByName("ambient",1),_.setMat4ByName("model",i);let a=n.mat4.create();a=n.mat4.multiply(a,e,r),_.setMat4ByName("viewProjection",a),this.skybox.draw(M),x.use(),x.setBoolByName("lights[0].is_enabled",!0),x.setVec4ByName("lights[0].position",[.34,.83,.44,0]),x.setVec3ByName("lights[0].ambient",[1,1,1]),x.setVec3ByName("lights[0].diffuse",[1,1,1]),x.setVec3ByName("lights[0].specular",[1,1,1]),x.setVec3(x.uniforms.camera_pos,L.position),M.enable(M.DEPTH_TEST),b.render(M,r,e)}end(t,e){if(I.textContent=Math.round(t)+" FPS",D.textContent="Score: "+this.world.pickup_manager.getScore(),e){var r=Math.round(v.resetFrameDelta());console.warn("Main loop panicked, probably because the browser tab was put in the background. Discarding "+r+"ms")}}doDemo(t){0,this.player.move(o.Player_Movement.FORWARD,t/2),this.player.rotate(t/8),B.front[0]=this.player.forward[0],B.front[2]=this.player.forward[2]}resize(){Math.min(window.innerHeight,window.innerWidth),p.width=window.innerWidth,p.height=window.innerHeight,M.viewport(0,0,M.drawingBufferWidth,M.drawingBufferHeight)}initPointerLock(){let t=p;p.requestFullscreen=p.requestFullscreen||t.mozRequestFullscreen||t.mozRequestFullScreen||p.webkitRequestFullscreen,p.addEventListener("click",p.requestFullscreen,!1),y.addEventListener("fullscreenchange",this.fullscreenChange,!1),y.addEventListener("mozfullscreenchange",this.fullscreenChange,!1),y.addEventListener("webkitfullscreenchange",this.fullscreenChange,!1),y.addEventListener("pointerlockchange",this.pointerLockChange,!1),y.addEventListener("mozpointerlockchange",this.pointerLockChange,!1),y.addEventListener("webkitpointerlockchange",this.pointerLockChange,!1)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){let t=new i.ARRAY_TYPE(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.clone=function(t){let e=new i.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,e,r,n){let a=new i.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=r,a[3]=n,a},e.set=function(t,e,r,i,n){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t},e.transpose=function(t,e){if(t===e){let r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},e.invert=function(t,e){let r=e[0],i=e[1],n=e[2],a=e[3],s=r*a-n*i;if(!s)return null;return s=1/s,t[0]=a*s,t[1]=-i*s,t[2]=-n*s,t[3]=r*s,t},e.adjoint=function(t,e){let r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=n,e.rotate=function(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=Math.sin(r),l=Math.cos(r);return t[0]=i*l+a*o,t[1]=n*l+s*o,t[2]=i*-o+a*l,t[3]=n*-o+s*l,t},e.scale=function(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=r[0],l=r[1];return t[0]=i*o,t[1]=n*o,t[2]=a*l,t[3]=s*l,t},e.fromRotation=function(t,e){let r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},e.str=function(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,e,r,i){return t[2]=i[2]/i[0],r[0]=i[0],r[1]=i[1],r[3]=i[3]-t[2]*r[1],[t,e,r]},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t},e.subtract=a,e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){let r=t[0],n=t[1],a=t[2],s=t[3],o=e[0],l=e[1],u=e[2],c=e[3];return Math.abs(r-o)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-l)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(a-u)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))&&Math.abs(s-c)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(c))},e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t},e.multiplyScalarAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t};var i=r(1);function n(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=r[0],l=r[1],u=r[2],c=r[3];return t[0]=i*o+a*l,t[1]=n*o+s*l,t[2]=i*u+a*c,t[3]=n*u+s*c,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}const s=n;e.mul=s;const o=a;e.sub=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){let t=new i.ARRAY_TYPE(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.clone=function(t){let e=new i.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.fromValues=function(t,e,r,n,a,s){let o=new i.ARRAY_TYPE(6);return o[0]=t,o[1]=e,o[2]=r,o[3]=n,o[4]=a,o[5]=s,o},e.set=function(t,e,r,i,n,a,s){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=a,t[5]=s,t},e.invert=function(t,e){let r=e[0],i=e[1],n=e[2],a=e[3],s=e[4],o=e[5],l=r*a-i*n;if(!l)return null;return l=1/l,t[0]=a*l,t[1]=-i*l,t[2]=-n*l,t[3]=r*l,t[4]=(n*o-a*s)*l,t[5]=(i*s-r*o)*l,t},e.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},e.multiply=n,e.rotate=function(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=Math.sin(r),c=Math.cos(r);return t[0]=i*c+a*u,t[1]=n*c+s*u,t[2]=i*-u+a*c,t[3]=n*-u+s*c,t[4]=o,t[5]=l,t},e.scale=function(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=r[0],c=r[1];return t[0]=i*u,t[1]=n*u,t[2]=a*c,t[3]=s*c,t[4]=o,t[5]=l,t},e.translate=function(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=r[0],c=r[1];return t[0]=i,t[1]=n,t[2]=a,t[3]=s,t[4]=i*u+a*c+o,t[5]=n*u+s*c+l,t},e.fromRotation=function(t,e){let r=Math.sin(e),i=Math.cos(e);return t[0]=i,t[1]=r,t[2]=-r,t[3]=i,t[4]=0,t[5]=0,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},e.str=function(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t},e.subtract=a,e.multiplyScalar=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t},e.multiplyScalarAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t[2]=e[2]+r[2]*i,t[3]=e[3]+r[3]*i,t[4]=e[4]+r[4]*i,t[5]=e[5]+r[5]*i,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},e.equals=function(t,e){let r=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],u=e[0],c=e[1],h=e[2],d=e[3],m=e[4],f=e[5];return Math.abs(r-u)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-c)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(a-h)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(h))&&Math.abs(s-d)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(o-m)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(l-f)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(f))};var i=r(1);function n(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=r[0],c=r[1],h=r[2],d=r[3],m=r[4],f=r[5];return t[0]=i*u+a*c,t[1]=n*u+s*c,t[2]=i*h+a*d,t[3]=n*h+s*d,t[4]=i*m+a*f+o,t[5]=n*m+s*f+l,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}const s=n;e.mul=s;const o=a;e.sub=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=function(){let t=new i.ARRAY_TYPE(8);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},e.clone=function(t){let e=new i.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},e.fromValues=function(t,e,r,n,a,s,o,l){let u=new i.ARRAY_TYPE(8);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=a,u[5]=s,u[6]=o,u[7]=l,u},e.fromRotationTranslationValues=function(t,e,r,n,a,s,o){let l=new i.ARRAY_TYPE(8);l[0]=t,l[1]=e,l[2]=r,l[3]=n;let u=.5*a,c=.5*s,h=.5*o;return l[4]=u*n+c*r-h*e,l[5]=c*n+h*t-u*r,l[6]=h*n+u*e-c*t,l[7]=-u*t-c*e-h*r,l},e.fromRotationTranslation=s,e.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},e.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},e.fromMat4=function(t,e){let r=n.create();a.getRotation(r,e);let o=new i.ARRAY_TYPE(3);return a.getTranslation(o,e),s(t,r,o),t},e.copy=o,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},e.set=function(t,e,r,i,n,a,s,o,l){return t[0]=e,t[1]=r,t[2]=i,t[3]=n,t[4]=a,t[5]=s,t[6]=o,t[7]=l,t},e.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},e.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},e.getTranslation=function(t,e){let r=e[4],i=e[5],n=e[6],a=e[7],s=-e[0],o=-e[1],l=-e[2],u=e[3];return t[0]=2*(r*u+a*s+i*l-n*o),t[1]=2*(i*u+a*o+n*s-r*l),t[2]=2*(n*u+a*l+r*o-i*s),t},e.translate=function(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=.5*r[0],l=.5*r[1],u=.5*r[2],c=e[4],h=e[5],d=e[6],m=e[7];return t[0]=i,t[1]=n,t[2]=a,t[3]=s,t[4]=s*o+n*u-a*l+c,t[5]=s*l+a*o-i*u+h,t[6]=s*u+i*l-n*o+d,t[7]=-i*o-n*l-a*u+m,t},e.rotateX=function(t,e,r){let i=-e[0],a=-e[1],s=-e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],d=l*o+h*i+u*s-c*a,m=u*o+h*a+c*i-l*s,f=c*o+h*s+l*a-u*i,p=h*o-l*i-u*a-c*s;return n.rotateX(t,e,r),i=t[0],a=t[1],s=t[2],o=t[3],t[4]=d*o+p*i+m*s-f*a,t[5]=m*o+p*a+f*i-d*s,t[6]=f*o+p*s+d*a-m*i,t[7]=p*o-d*i-m*a-f*s,t},e.rotateY=function(t,e,r){let i=-e[0],a=-e[1],s=-e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],d=l*o+h*i+u*s-c*a,m=u*o+h*a+c*i-l*s,f=c*o+h*s+l*a-u*i,p=h*o-l*i-u*a-c*s;return n.rotateY(t,e,r),i=t[0],a=t[1],s=t[2],o=t[3],t[4]=d*o+p*i+m*s-f*a,t[5]=m*o+p*a+f*i-d*s,t[6]=f*o+p*s+d*a-m*i,t[7]=p*o-d*i-m*a-f*s,t},e.rotateZ=function(t,e,r){let i=-e[0],a=-e[1],s=-e[2],o=e[3],l=e[4],u=e[5],c=e[6],h=e[7],d=l*o+h*i+u*s-c*a,m=u*o+h*a+c*i-l*s,f=c*o+h*s+l*a-u*i,p=h*o-l*i-u*a-c*s;return n.rotateZ(t,e,r),i=t[0],a=t[1],s=t[2],o=t[3],t[4]=d*o+p*i+m*s-f*a,t[5]=m*o+p*a+f*i-d*s,t[6]=f*o+p*s+d*a-m*i,t[7]=p*o-d*i-m*a-f*s,t},e.rotateByQuatAppend=function(t,e,r){let i=r[0],n=r[1],a=r[2],s=r[3],o=e[0],l=e[1],u=e[2],c=e[3];return t[0]=o*s+c*i+l*a-u*n,t[1]=l*s+c*n+u*i-o*a,t[2]=u*s+c*a+o*n-l*i,t[3]=c*s-o*i-l*n-u*a,o=e[4],l=e[5],u=e[6],c=e[7],t[4]=o*s+c*i+l*a-u*n,t[5]=l*s+c*n+u*i-o*a,t[6]=u*s+c*a+o*n-l*i,t[7]=c*s-o*i-l*n-u*a,t},e.rotateByQuatPrepend=function(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=r[0],l=r[1],u=r[2],c=r[3];return t[0]=i*c+s*o+n*u-a*l,t[1]=n*c+s*l+a*o-i*u,t[2]=a*c+s*u+i*l-n*o,t[3]=s*c-i*o-n*l-a*u,o=r[4],l=r[5],u=r[6],c=r[7],t[4]=i*c+s*o+n*u-a*l,t[5]=n*c+s*l+a*o-i*u,t[6]=a*c+s*u+i*l-n*o,t[7]=s*c-i*o-n*l-a*u,t},e.rotateAroundAxis=function(t,e,r,n){if(Math.abs(n)<i.EPSILON)return o(t,e);let a=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);n*=.5;let s=Math.sin(n),l=s*r[0]/a,u=s*r[1]/a,c=s*r[2]/a,h=Math.cos(n),d=e[0],m=e[1],f=e[2],p=e[3];t[0]=d*h+p*l+m*c-f*u,t[1]=m*h+p*u+f*l-d*c,t[2]=f*h+p*c+d*u-m*l,t[3]=p*h-d*l-m*u-f*c;let M=e[4],_=e[5],x=e[6],b=e[7];return t[4]=M*h+b*l+_*c-x*u,t[5]=_*h+b*u+x*l-M*c,t[6]=x*h+b*c+M*u-_*l,t[7]=b*h-M*l-_*u-x*c,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t},e.multiply=c,e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t},e.lerp=function(t,e,r,i){let n=1-i;d(e,r)<0&&(i=-i);return t[0]=e[0]*n+r[0]*i,t[1]=e[1]*n+r[1]*i,t[2]=e[2]*n+r[2]*i,t[3]=e[3]*n+r[3]*i,t[4]=e[4]*n+r[4]*i,t[5]=e[5]*n+r[5]*i,t[6]=e[6]*n+r[6]*i,t[7]=e[7]*n+r[7]*i,t},e.invert=function(t,e){let r=p(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},e.normalize=function(t,e){let r=p(e);r>0&&(r=Math.sqrt(r),t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r,t[3]=e[3]/r,t[4]=e[4]/r,t[5]=e[5]/r,t[6]=e[6]/r,t[7]=e[7]/r);return t},e.str=function(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},e.equals=function(t,e){let r=t[0],n=t[1],a=t[2],s=t[3],o=t[4],l=t[5],u=t[6],c=t[7],h=e[0],d=e[1],m=e[2],f=e[3],p=e[4],M=e[5],_=e[6],x=e[7];return Math.abs(r-h)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(h))&&Math.abs(n-d)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(a-m)<=i.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(s-f)<=i.EPSILON*Math.max(1,Math.abs(s),Math.abs(f))&&Math.abs(o-p)<=i.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(l-M)<=i.EPSILON*Math.max(1,Math.abs(l),Math.abs(M))&&Math.abs(u-_)<=i.EPSILON*Math.max(1,Math.abs(u),Math.abs(_))&&Math.abs(c-x)<=i.EPSILON*Math.max(1,Math.abs(c),Math.abs(x))};var i=r(1),n=r(9),a=r(8);function s(t,e,r){let i=.5*r[0],n=.5*r[1],a=.5*r[2],s=e[0],o=e[1],l=e[2],u=e[3];return t[0]=s,t[1]=o,t[2]=l,t[3]=u,t[4]=i*u+n*l-a*o,t[5]=n*u+a*s-i*l,t[6]=a*u+i*o-n*s,t[7]=-i*s-n*o-a*l,t}function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}const l=n.copy;e.getReal=l;const u=n.copy;function c(t,e,r){let i=e[0],n=e[1],a=e[2],s=e[3],o=r[4],l=r[5],u=r[6],c=r[7],h=e[4],d=e[5],m=e[6],f=e[7],p=r[0],M=r[1],_=r[2],x=r[3];return t[0]=i*x+s*p+n*_-a*M,t[1]=n*x+s*M+a*p-i*_,t[2]=a*x+s*_+i*M-n*p,t[3]=s*x-i*p-n*M-a*_,t[4]=i*c+s*o+n*u-a*l+h*x+f*p+d*_-m*M,t[5]=n*c+s*l+a*o-i*u+d*x+f*M+m*p-h*_,t[6]=a*c+s*u+i*l-n*o+m*x+f*_+h*M-d*p,t[7]=s*c-i*o-n*l-a*u+f*x-h*p-d*M-m*_,t}e.setReal=u;const h=c;e.mul=h;const d=n.dot;e.dot=d;const m=n.length;e.length=m;const f=m;e.len=f;const p=n.squaredLength;e.squaredLength=p;const M=p;e.sqrLen=M},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.create=n,e.clone=function(t){let e=new i.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},e.fromValues=function(t,e){let r=new i.ARRAY_TYPE(2);return r[0]=t,r[1]=e,r},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},e.set=function(t,e,r){return t[0]=e,t[1]=r,t},e.add=function(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t},e.subtract=a,e.multiply=s,e.divide=o,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},e.min=function(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t},e.max=function(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},e.scale=function(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t},e.scaleAndAdd=function(t,e,r,i){return t[0]=e[0]+r[0]*i,t[1]=e[1]+r[1]*i,t},e.distance=l,e.squaredDistance=u,e.length=c,e.squaredLength=h,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},e.normalize=function(t,e){var r=e[0],i=e[1],n=r*r+i*i;n>0&&(n=1/Math.sqrt(n),t[0]=e[0]*n,t[1]=e[1]*n);return t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},e.cross=function(t,e,r){var i=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=i,t},e.lerp=function(t,e,r,i){var n=e[0],a=e[1];return t[0]=n+i*(r[0]-n),t[1]=a+i*(r[1]-a),t},e.random=function(t,e){e=e||1;var r=2*i.RANDOM()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t},e.transformMat2=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n,t[1]=r[1]*i+r[3]*n,t},e.transformMat2d=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[2]*n+r[4],t[1]=r[1]*i+r[3]*n+r[5],t},e.transformMat3=function(t,e,r){var i=e[0],n=e[1];return t[0]=r[0]*i+r[3]*n+r[6],t[1]=r[1]*i+r[4]*n+r[7],t},e.transformMat4=function(t,e,r){let i=e[0],n=e[1];return t[0]=r[0]*i+r[4]*n+r[12],t[1]=r[1]*i+r[5]*n+r[13],t},e.str=function(t){return"vec2("+t[0]+", "+t[1]+")"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},e.equals=function(t,e){let r=t[0],n=t[1],a=e[0],s=e[1];return Math.abs(r-a)<=i.EPSILON*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(n-s)<=i.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))};var i=r(1);function n(){let t=new i.ARRAY_TYPE(2);return t[0]=0,t[1]=0,t}function a(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function s(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function o(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function l(t,e){var r=e[0]-t[0],i=e[1]-t[1];return Math.sqrt(r*r+i*i)}function u(t,e){var r=e[0]-t[0],i=e[1]-t[1];return r*r+i*i}function c(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)}function h(t){var e=t[0],r=t[1];return e*e+r*r}const d=c;e.len=d;const m=a;e.sub=m;const f=s;e.mul=f;const p=o;e.div=p;const M=l;e.dist=M;const _=u;e.sqrDist=_;const x=h;e.sqrLen=x;const b=function(){let t=n();return function(e,r,i,n,a,s){let o,l;for(r||(r=2),i||(i=0),l=n?Math.min(n*r+i,e.length):e.length,o=i;o<l;o+=r)t[0]=e[o],t[1]=e[o+1],a(t,t,s),e[o]=t[0],e[o+1]=t[1];return e}}();e.forEach=b},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(0),n=90,a=0,s=20,o=.1,l=65;var u;!function(t){t[t.FORWARD=0]="FORWARD",t[t.BACKWARD=1]="BACKWARD",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT"}(u=e.Camera_Movement||(e.Camera_Movement={}));e.Camera=class{constructor(t=i.vec3.fromValues(0,0,0),e=i.vec3.fromValues(0,1,0),r=n,u=a){this.position=t,this.front=i.vec3.fromValues(0,0,-1),this.worldUp=e,this.movementSpeed=s,this.mouseSensitivity=o,this.zoom=l,this.yaw=r,this.pitch=u,this.updateCameraVectors()}getViewMatrix(){let t=i.vec3.create();i.vec3.add(t,this.position,this.front);let e=i.mat4.create();return i.mat4.lookAt(e,this.position,t,this.up),e}lookAt(t){let e=i.vec3.create();i.vec3.subtract(e,t,this.position),i.vec3.normalize(e,e),this.front=e}getInverseViewMatrix(){let t=i.vec3.create();i.vec3.add(t,this.position,this.front);let e=i.mat4.create();return i.mat4.lookAt(e,this.position,t,this.up),i.mat4.invert(e,e),e}processKeyboard(t,e){let r=this.movementSpeed*e,n=this.front,a=this.right;if(t==u.FORWARD){let t=i.vec3.create();i.vec3.scale(t,n,r),i.vec3.add(this.position,this.position,t)}if(t==u.BACKWARD){let t=i.vec3.create();i.vec3.scale(t,n,-r),i.vec3.add(this.position,this.position,t)}if(t==u.LEFT){let t=i.vec3.create();i.vec3.scale(t,a,-r),i.vec3.add(this.position,this.position,t)}if(t==u.RIGHT){let t=i.vec3.create();i.vec3.scale(t,a,r),i.vec3.add(this.position,this.position,t)}}processMouseMovement(t,e,r,i,n=!0){this.mouseSensitivity,i*=this.mouseSensitivity,this.pitch+=i;let a=Math.atan2(t[0],t[2]);a+=Math.PI,a=360-(a*=360/(2*Math.PI))-90,n&&(this.pitch>20&&(this.pitch=20),this.pitch<-20&&(this.pitch=-20),this.yaw>a+0&&(this.yaw=a+0),this.yaw<a-0&&(this.yaw=a-0)),this.updateCameraVectors()}updateCameraVectors(){let t=Math.cos(i.glMatrix.toRadian(this.yaw))*Math.cos(i.glMatrix.toRadian(this.pitch)),e=Math.sin(i.glMatrix.toRadian(this.pitch)),r=Math.sin(i.glMatrix.toRadian(this.yaw))*Math.cos(i.glMatrix.toRadian(this.pitch)),n=i.vec3.fromValues(t,e,r);i.vec3.normalize(n,n),this.front=n;let a=i.vec3.create();i.vec3.normalize(a,i.vec3.cross(a,this.front,this.worldUp)),this.right=a;let s=i.vec3.create();i.vec3.normalize(s,i.vec3.cross(s,this.right,this.front)),this.up=s}}},function(t,e,r){"use strict";var i=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))(function(n,a){function s(t){try{l(i.next(t))}catch(t){a(t)}}function o(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){t.done?n(t.value):new r(function(e){e(t.value)}).then(s,o)}l((i=i.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const n=r(0),a=r(25),s=r(2),o=r(4);let l=r(3);const u=10;var c;!function(t){t[t.FORWARD=0]="FORWARD",t[t.BACKWARD=1]="BACKWARD",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT"}(c=e.Player_Movement||(e.Player_Movement={}));class h extends o.Entity{constructor(t,e,r){super(e.name,o.Model_Type.BASIC,r,n.vec3.fromValues(0,0,-1)),this.model=new a.PlayerModel(e),this.model.rotation_offset=n.vec3.fromValues(0,0,-Math.PI/2),this.model.init(t),this.up=n.vec3.fromValues(0,1,0)}rotate(t){n.vec3.rotateY(this.forward,this.forward,[0,0,0],2*t)}move(t,e){let r=n.vec3.create();if(t==c.FORWARD)n.vec3.scale(r,this.forward,u*e),n.vec3.add(this.position,this.position,r);else if(t==c.BACKWARD)n.vec3.scale(r,this.forward,-u*e*.5),n.vec3.add(this.position,this.position,r);else if(t==c.LEFT){let t=n.vec3.create();n.vec3.copy(t,this.forward),n.vec3.rotateY(t,t,[0,0,0],Math.PI/2),n.vec3.scale(r,t,u*e),n.vec3.add(this.position,this.position,r)}else if(t==c.RIGHT){let t=n.vec3.create();n.vec3.copy(t,this.forward),n.vec3.rotateY(t,t,[0,0,0],-Math.PI/2),n.vec3.scale(r,t,u*e),n.vec3.add(this.position,this.position,r)}}draw(t,e,r){let i=n.mat4.create();n.mat4.translate(i,i,this.position),n.mat4.rotateY(i,i,Math.atan2(this.forward[0],this.forward[2])-Math.PI/2),s.BasicModel.setMVPMatrices(i,e,r),this.model.draw(t)}static loadMesh(){return i(this,void 0,void 0,function*(){return l.downloadModels([{name:"cbabe",obj:"/assets/models/actors/cbabe/cbabe_stand.obj",mtl:"/assets/models/actors/cbabe/cbabe.mtl"}])})}}h.radius=.25,h.half_height=.8,e.Player=h},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(2);e.PlayerModel=class extends i.BasicModel{constructor(t){super(t)}init(t){super.init(t)}}},function(t,e,r){"use strict";e.d=a,e.c=function(t){s=window.location.href.substr(0,window.location.href.lastIndexOf("/"));const e=[];for(const r of t){const t=[];if(!r.obj)throw new Error('"obj" attribute of model object not set. The .obj file is required to be set in order to use downloadModels()');let o=r.name;if(!o){let t=r.obj.split("/");o=t[t.length-1].replace(".obj","")}if(t.push(Promise.resolve(o)),t.push(fetch(s+r.obj).then(t=>t.text()).then(t=>new i.a(t))),r.mtl){let e=r.mtl;"boolean"==typeof e&&(e=r.obj.replace(/\.obj$/,".mtl")),t.push(fetch(s+e).then(t=>t.text()).then(t=>{let i=new n.b(t);if(!1!==r.downloadMtlTextures){let t=r.mtlTextureRoot;return t||(t=e.substr(0,e.lastIndexOf("/"))),Promise.all([Promise.resolve(i),a(i,s+t)])}return Promise.all(Promise.resolve(i))}).then(t=>t[0]))}e.push(Promise.all(t))}return Promise.all(e).then(t=>{const e={};for(const r of t){const[t,i,n]=r;i.name=t,n&&i.addMaterialLibrary(n),e[t]=i}return e})},e.b=function(t,e,r){void 0===r&&(r={});const n=[];for(const e in t){if(!t.hasOwnProperty(e))continue;const r=t[e];n.push(fetch(r).then(t=>t.text()).then(t=>[e,new i.a(t)]))}Promise.all(n).then(t=>{for(let[e,i]of t)r[e]=i;return e(r)})},e.e=function(t,e){e.normalBuffer=o(t,t.ARRAY_BUFFER,e.vertexNormals,3),e.textureBuffer=o(t,t.ARRAY_BUFFER,e.textures,2),e.vertexBuffer=o(t,t.ARRAY_BUFFER,e.vertices,3),e.indexBuffer=o(t,t.ELEMENT_ARRAY_BUFFER,e.indices,1)},e.a=function(t,e){t.deleteBuffer(e.normalBuffer),t.deleteBuffer(e.textureBuffer),t.deleteBuffer(e.vertexBuffer),t.deleteBuffer(e.indexBuffer)};var i=r(13),n=r(14);r(5);function a(t,e){const r=["mapDiffuse","mapAmbient","mapSpecular","mapDissolve","mapBump","mapDisplacement","mapDecal","mapEmissive"];e.endsWith("/")||(e+="/");let i=[];for(let n in t.materials){if(!t.materials.hasOwnProperty(n))continue;n=t.materials[n];let a={};for(let t of r){let r=n[t];if(!r)continue;let s=e+r.filename;a.hasOwnProperty(r.filename)?r.texture=a[r.filename]:(a[r.filename]=new Image,i.push(fetch(s).then(t=>{if(!t.ok)throw new Error;return t.blob()}).then(function(t){a[r.filename].src=URL.createObjectURL(t),r.texture=a[r.filename]}).catch(()=>{console.error(`Unable to download texture: ${s}`)})))}}return Promise.all(i)}let s;var o=function(t,e,r,i){var n=t.createBuffer(),a=e===t.ARRAY_BUFFER?Float32Array:Uint16Array;return t.bindBuffer(e,n),t.bufferData(e,new a(r),t.STATIC_DRAW),n.itemSize=i,n.numItems=r.length/i,n}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Guid=class{static newGuid(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})}}},function(t,e,r){"use strict";var i=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))(function(n,a){function s(t){try{l(i.next(t))}catch(t){a(t)}}function o(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){t.done?n(t.value):new r(function(e){e(t.value)}).then(s,o)}l((i=i.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const n=r(15),a=r(32);let s=r(3);const o=r(3),l=r(0),u=r(6),c=r(16),h=r(33),d=r(2);e.World=class{constructor(t,e,r,i,s){this.pickup_manager=new h.PickupManager,this.disks=[],r.DiskA.addMaterialLibrary(i),r.DiskB.addMaterialLibrary(i),r.DiskC.addMaterialLibrary(i),r.DiskD.addMaterialLibrary(i),r.DiskE.addMaterialLibrary(i),this.diskAModel=new a.DiskModel(r.DiskA),this.diskBModel=new a.DiskModel(r.DiskB),this.diskCModel=new a.DiskModel(r.DiskC),this.diskDModel=new a.DiskModel(r.DiskD),this.diskEModel=new a.DiskModel(r.DiskE),this.rod_model=new d.BasicModel(s.Rod),this.ring_model=new d.BasicModel(s.Ring),this.diskAModel.init(t),this.diskBModel.init(t),this.diskCModel.init(t),this.diskDModel.init(t),this.diskEModel.init(t),this.rod_model.init(t),this.ring_model.init(t),this.pickup_manager.init(this,this.rod_model,this.ring_model);const o=e.split("\n");-1==o[0].indexOf("version 1")&&console.warn("Can't read Disk World File"),this.world_radius=parseInt(o[1]);let u=parseInt(o[2]);o.splice(0,3);for(let t=0;t<u;t++){let e=o[t].split("\t"),r=parseFloat(e[0]),i=parseFloat(e[1]),a=parseFloat(e[2]),s=null,l=null;switch(!0){case a<8:s=this.diskAModel,l=n.Terrain.RED_ROCK;break;case a<=12:s=this.diskBModel,l=n.Terrain.LEAFY;break;case a<=20:s=this.diskCModel,l=n.Terrain.ICY;break;case a<=30:s=this.diskDModel,l=n.Terrain.SANDY;break;case a>30:s=this.diskEModel,l=n.Terrain.GREY_ROCK}if(!s)throw"No Disk Model found for radius: "+a;this.disks.push(new n.Disk(s,l,a,r,0,i))}this.disks.forEach(e=>{e.init(t);let r=l.vec3.fromValues(e.position[0],e.getHeightAtPosition(e.position[0],e.position[2]),e.position[2]);this.pickup_manager.addRod(r,e.type+1),this.pickup_manager.addRing(r)})}update(t){this.pickup_manager.update(t)}draw(t,e,r){this.disks.forEach(i=>{i.draw(t,e,r)})}getSpeedFactorAtPosition(t,e,r=0){for(let i=0;i<this.disks.length;i++)if(u.Collision.circleIntersection(t,e,r,this.disks[i].position[0],this.disks[i].position[2],this.disks[i].radius))return this.disks[i].getSpeedFactor();return 1}getRandomDiskPosition(){let t=c.Random.randi(this.disks.length-1);return this.disks[t].position}getHeightAtPointPosition(t,e){return this.getHeightAtCirclePosition(t,e,0)}getHeightAtCirclePosition(t,e,r){for(let i=0;i<this.disks.length;i++)if(u.Collision.circleIntersection(t,e,r,this.disks[i].position[0],this.disks[i].position[2],this.disks[i].radius))return this.disks[i].getHeightAtPosition(t,e);return 0}static loadPickupMeshes(){return i(this,void 0,void 0,function*(){return s.downloadModels([{name:"Ring",obj:"/assets/models/environment/ring/Ring.obj",mtl:"/assets/models/environment/ring/Ring.mtl"},{name:"Rod",obj:"/assets/models/environment/rod/Rod.obj",mtl:"/assets/models/environment/rod/Rod.mtl"}])})}static loadWorldMeshes(){return i(this,void 0,void 0,function*(){return s.downloadModels([{name:"DiskA",obj:"/assets/models/environment/disks/DiskA.obj",downloadMtlTextures:!1},{name:"DiskB",obj:"/assets/models/environment/disks/DiskB.obj",downloadMtlTextures:!1},{name:"DiskC",obj:"/assets/models/environment/disks/DiskC.obj",downloadMtlTextures:!1},{name:"DiskD",obj:"/assets/models/environment/disks/DiskD.obj",downloadMtlTextures:!1},{name:"DiskE",obj:"/assets/models/environment/disks/DiskE.obj",downloadMtlTextures:!1}])})}static loadWorldMat(){return i(this,void 0,void 0,function*(){let t=new o.MaterialLibrary(r(36));return yield s.downloadMtlTextures(t,window.location.href.substr(0,window.location.href.lastIndexOf("/"))+"/assets/models/environment/disks/"),t})}static loadWorldData(){return i(this,void 0,void 0,function*(){return r(37)})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(15),n=r(2),a=r(0);e.MeshlessModel=class{constructor(t,e,r){this.data=t,this.indices=e,this.stride=8,this.name="height_map_model_"+i.Disk.height_map_model_gen_count,this.material=r,this.rotation_offset=a.vec3.fromValues(0,0,0)}init(t){this.VAO=t.createVertexArray(),this.buffer=t.createBuffer(),this.index_buffer=t.createBuffer(),t.bindVertexArray(this.VAO),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bufferData(t.ARRAY_BUFFER,this.data,t.STATIC_DRAW),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.index_buffer),t.bufferData(t.ELEMENT_ARRAY_BUFFER,this.indices,t.STATIC_DRAW),t.enableVertexAttribArray(0),t.vertexAttribPointer(0,3,t.FLOAT,!1,4*this.stride,0),t.enableVertexAttribArray(1),t.vertexAttribPointer(1,2,t.FLOAT,!0,4*this.stride,12),t.enableVertexAttribArray(2),t.vertexAttribPointer(2,3,t.FLOAT,!0,4*this.stride,20),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindVertexArray(null),this.texture=this.material.mapDiffuse.texture_id,this.initialized=!0}activateBuffers(t){t.bindVertexArray(this.VAO),t.bindBuffer(t.ARRAY_BUFFER,this.buffer),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.index_buffer)}activateMaterial(t){this.material.isTextureActive[0]&&this.material.mapTransparency.texture_id&&(t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,this.material.mapTransparency.texture_id)),this.material.isTextureActive[1]&&this.material.mapEmissive.texture_id&&(t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,this.material.mapEmissive.texture_id)),this.material.isTextureActive[2]&&this.material.mapAmbient.texture_id&&(t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,this.material.mapAmbient.texture_id)),this.material.isTextureActive[3]&&this.material.mapDiffuse.texture_id&&(t.activeTexture(t.TEXTURE3),t.bindTexture(t.TEXTURE_2D,this.material.mapDiffuse.texture_id)),this.material.isTextureActive[4]&&this.material.mapSpecular.texture_id&&(t.activeTexture(t.TEXTURE4),t.bindTexture(t.TEXTURE_2D,this.material.mapSpecular.texture_id)),this.material.isTextureActive[5]&&this.material.mapSpecularExponent.texture_id&&(t.activeTexture(t.TEXTURE5),t.bindTexture(t.TEXTURE_2D,this.material.mapSpecularExponent.texture_id)),n.BasicModel.shader.setFloat(n.BasicModel.shader.uniforms.material_transparency,this.material.transparency),n.BasicModel.shader.setVec3(n.BasicModel.shader.uniforms.material_ambient_colour,this.material.ambient),n.BasicModel.shader.setVec3(n.BasicModel.shader.uniforms.material_diffuse_colour,this.material.diffuse),n.BasicModel.shader.setVec3(n.BasicModel.shader.uniforms.material_specular_colour,this.material.specular),n.BasicModel.shader.setVec3(n.BasicModel.shader.uniforms.material_emissive_colour,this.material.emissive),n.BasicModel.shader.setFloat(n.BasicModel.shader.uniforms.material_shininess,this.material.specularExponent),n.BasicModel.shader.setIntV(n.BasicModel.shader.uniforms.material_is_texture_active,this.material.isTextureActive)}draw(t){this.activateBuffers(t),this.activateMaterial(t),this.drawActivatedMaterial(t)}drawActivatedMaterial(t){t.drawElements(t.TRIANGLES,this.indices.length,t.UNSIGNED_SHORT,0)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Noisefield=class{constructor(t,e,r,i,n,a,s,o,l){this.GRID_SIZE=t,this.amplitude=e,this.SEED_X1=r,this.SEED_X2=i,this.SEED_Y1=n,this.SEED_Y2=a,this.SEED_Q0=s,this.SEED_Q1=o,this.SEED_Q2=l}pseudorandom(t,e){let r=this.SEED_X1*t+this.SEED_Y1*e;return this.SEED_Q2*r*r+this.SEED_Q1*r+this.SEED_Q0+this.SEED_X2*t+this.SEED_Y2*e}fade(t){return t*t*t*t*t*6-t*t*t*t*15+t*t*t*10}lattice(t,e){let r=2*this.pseudorandom(t,e)*Math.PI;return{x:Math.cos(r),y:Math.sin(r)}}perlineNoise(t,e){let r=Math.floor(t/this.GRID_SIZE),i=Math.floor(e/this.GRID_SIZE),n=t/this.GRID_SIZE-r,a=e/this.GRID_SIZE-i,s=r+1,o=i+1,l=this.lattice(r,i),u=this.lattice(r,o),c=this.lattice(s,i),h=this.lattice(s,o),d={x:-n,y:-a},m={x:-n,y:1-a},f={x:1-n,y:-a},p={x:1-n,y:1-a},M=this.dotProduct(l,d),_=this.dotProduct(u,m),x=this.dotProduct(c,f),b=this.dotProduct(h,p),v=this.fade(n),y=this.fade(a),g=1-y;return((M*g+_*y)*(1-v)+(x*g+b*y)*v)*this.amplitude}dotProduct(t,e){return t.x*e.x+t.y*e.y}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(0);!function(t){t.barycentric=function(t,e,r,n){let a=i.vec2.create(),s=i.vec2.create(),o=i.vec2.create();i.vec2.sub(a,r,e),i.vec2.sub(s,n,e),i.vec2.sub(o,t,e);let l=i.vec2.dot(a,a),u=i.vec2.dot(a,s),c=i.vec2.dot(s,s),h=i.vec2.dot(o,a),d=i.vec2.dot(o,s),m=1/(l*c-u*u),f=i.vec3.create();return f[1]=(c*h-u*d)*m,f[2]=(l*d-u*h)*m,f[0]=1-f[1]-f[2],f}}(e.MathHelper||(e.MathHelper={}))},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(2);e.DiskModel=class extends i.BasicModel{constructor(t){super(t)}init(t){super.init(t);let e=t.createTexture();t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e);const r=new Uint8Array([0,0,0,255]);t.texImage2D(t.TEXTURE_2D,0,t.RGB,1,1,0,t.RGB,t.UNSIGNED_BYTE,r),this.setTexture(e,1)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(34),n=r(35),a=r(6);e.PickupManager=class{constructor(){}init(t,e,r){this.score=0,this.world=t,this.rod_model=e,this.ring_model=r,this.rings=[],this.rods=[]}update(t){this.rings.forEach(e=>{e.picked_up||e.update(t)})}checkForPickupsCylinderIntersection(t,e,r,s){this.rings.forEach(n=>{n.picked_up||a.Collision.cylinderIntersection(t,e,r,n.position,i.Ring.radius,i.Ring.half_height)&&(n.picked_up=!0,this.score+=i.Ring.point_value,s.removeEntity(n))}),this.rods.forEach(i=>{i.picked_up||a.Collision.cylinderIntersection(t,e,r,i.position,n.Rod.radius,n.Rod.half_height)&&(i.picked_up=!0,this.score+=i.point_value,s.removeEntity(i))})}addRod(t,e){this.rods.push(new n.Rod(this.rod_model,t,e))}addRing(t){this.rings.push(new i.Ring(this.rings.length,this.world,this.ring_model,t))}getScore(){return this.score}destroy(){this.rings=[],this.rods=[],this.score=0}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(4),n=r(0),a=r(6);class s extends i.Entity{constructor(t,e,r,n){super(r.mesh.name,i.Model_Type.BASIC,n),this.picked_up=!1,this.target_position=n,this.world=e}update(t){let e=n.vec3.create();n.vec3.sub(e,this.target_position,this.position),n.vec3.normalize(e,e);let r=this.world.getSpeedFactorAtPosition(this.position[0],this.position[2]),i=s.speed*t*r;n.vec3.scaleAndAdd(this.position,this.position,e,i);let o=s.rotation_speed*i;n.vec3.rotateY(this.forward,this.forward,n.vec3.create(),o),this.position[1]=this.world.getHeightAtCirclePosition(this.position[0],this.position[2],s.radius)+2*s.half_height,a.Collision.pointCircleIntersection(this.target_position[0],this.target_position[2],this.position[0],this.position[2],s.radius)&&(this.target_position=this.world.getRandomDiskPosition())}}s.point_value=1,s.speed=2.5,s.rotation_speed=1.3,s.radius=.7,s.half_height=.1,e.Ring=s},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(4);class n extends i.Entity{constructor(t,e,r){super(t.mesh.name,i.Model_Type.BASIC,e),this.picked_up=!1,this.position=e,this.point_value=r}update(t){}}n.radius=.1,n.half_height=1,e.Rod=n},function(t,e){t.exports="#\r\n#  Disks.mtl\r\n#\r\n\r\nnewmtl diskA\r\nillum 1\r\nKd 0.80 0.80 0.80\r\nKa 0.20 0.20 0.20\r\nmap_Kd DiskA.jpg\r\nmap_Ka DiskA.jpg\r\n\r\nnewmtl diskA_side\r\nillum 1\r\nKd 0.80 0.80 0.80\r\nKa 0.20 0.20 0.20\r\nmap_Kd DiskA_side.jpg\r\nmap_Ka DiskA_side.jpg\r\n\r\nnewmtl diskB\r\nillum 1\r\nKd 0.80 0.80 0.80\r\nKa 0.20 0.20 0.20\r\nmap_Kd DiskB.jpg\r\nmap_Ka DiskB.jpg\r\n\r\nnewmtl diskB_side\r\nillum 1\r\nKd 0.80 0.80 0.80\r\nKa 0.20 0.20 0.20\r\nmap_Kd DiskB_side.jpg\r\nmap_Ka DiskB_side.jpg\r\n\r\nnewmtl diskC\r\nillum 1\r\nKd 0.80 0.80 0.80\r\nKa 0.20 0.20 0.20\r\nmap_Kd DiskC.jpg\r\nmap_Ka DiskC.jpg\r\n\r\n\r\nnewmtl diskC_side\r\nillum 1\r\nKd 0.80 0.80 0.80\r\nKa 0.20 0.20 0.20\r\nmap_Kd DiskC_side.jpg\r\nmap_Ka DiskC_side.jpg\r\n\r\nnewmtl diskD\r\nillum 1\r\nKd 0.80 0.80 0.80\r\nKa 0.20 0.20 0.20\r\nKs 0.0 0.0 0.0\r\nmap_Kd DiskD.jpg\r\nmap_Ka DiskD.jpg\r\n\r\nnewmtl diskD_side\r\nillum 1\r\nKd 0.80 0.80 0.80\r\nKa 0.20 0.20 0.20\r\nmap_Kd DiskD_side.jpg\r\nmap_Ka DiskD_side.jpg\r\n\r\nnewmtl diskE\r\nillum 1\r\nKd 0.80 0.80 0.80\r\nKa 0.20 0.20 0.20\r\nmap_Kd DiskE.jpg\r\nmap_Ka DiskE.jpg\r\n\r\nnewmtl diskE_side\r\nillum 1\r\nKd 0.80 0.80 0.80\r\nKa 0.20 0.20 0.20\r\nmap_Kd DiskE_side.jpg\r\nmap_Ka DiskE_side.jpg\r\n\r\nnewmtl flat_black\r\nillum 0\r\nKd 0.00 0.00 0.00\r\nKa 0.00 0.00 0.00\r\n\r\nnewmtl rainbow\r\nillum 1\r\nKd 0.80 0.80 0.80\r\nKa 0.20 0.20 0.20\r\nmap_Kd Rainbow.jpg\r\nmap_Ka Rainbow.jpg\r\n"},function(t,e){t.exports="DISK version 1\r\n159.835\r\n61\r\n5.61676\t34.6006\t6.55774\t\r\n4.5521\t49.1698\t8.0504\t\r\n6.29182\t17.456\t10.6\t\r\n19.2771\t30.399\t7.7341\t\r\n-5.63964\t-6.61964\t16.2699\t\r\n-34.8144\t-13.928\t13.8063\t\r\n17.7224\t44.1054\t6.06006\t\r\n16.9081\t56.4082\t6.2697\t\r\n-51.3318\t-2.99788\t6\t\r\n-61.6816\t3.18528\t6.0561\t\r\n2.67116\t-44.403\t22.4166\t\r\n-61.7976\t-8.87178\t6.00154\t\r\n20.3596\t-15.7251\t11.2777\t\r\n53.2492\t45.6392\t29.4998\t\r\n28.4818\t20.19\t6.01188\t\r\n-56.16\t-23.3322\t9.51902\t\r\n29.7014\t5.71352\t8.51594\t\r\n-4.05204\t60.2884\t6.00862\t\r\n-73.0756\t12.5486\t8.6916\t\r\n-13.4131\t76.324\t12.5593\t\r\n-73.0176\t-2.86702\t6.72414\t\r\n-72.7376\t-17.5524\t7.96394\t\r\n-69.9778\t-32.1062\t6.84908\t\r\n-21.5382\t-69.3478\t12.3445\t\r\n-43.1694\t-31.9836\t6.08872\t\r\n10.4786\t-94.7314\t28.5138\t\r\n68.47\t106.494\t33.2292\t\r\n-55.834\t-44.7244\t11.8756\t\r\n-90.5932\t35.5246\t20.2006\t\r\n-42.9236\t-77.4838\t10.5364\t\r\n58.784\t-6.65676\t23.0884\t\r\n30.7258\t-49.0178\t6.01498\t\r\n-23.5632\t-87.8066\t6.22514\t\r\n-50.58\t-62.8268\t6\t\r\n35.7504\t-30.2686\t9.89758\t\r\n-48.2148\t94.9572\t26.9168\t\r\n29.0574\t108.357\t6.22754\t\r\n-82.3006\t-74.0996\t27.664\t\r\n31.4576\t120.811\t6.45576\t\r\n106.947\t61.002\t26.3522\t\r\n-71.8658\t55.0002\t6.81826\t\r\n-14.8019\t95.3308\t6.4983\t\r\n-87.6702\t-35.6198\t11.1887\t\r\n39.751\t-56.9514\t6.00168\t\r\n-1.16644\t108.714\t12.6072\t\r\n42.0084\t-44.884\t6.0011\t\r\n-115.571\t-43.2198\t17.7283\t\r\n-10.0822\t-128.608\t11.1144\t\r\n-72.6896\t69.6884\t7.89294\t\r\n39.1888\t-68.9426\t6.0027\t\r\n42.1076\t-80.6828\t6.09486\t\r\n-59.1878\t-102.758\t7.0319\t\r\n-99.9152\t88.4796\t25.1878\t\r\n-117.585\t54.717\t12.919\t\r\n50.7834\t-36.2758\t6.29124\t\r\n53.196\t-63.5894\t8.99256\t\r\n-59.0672\t-116.049\t6.25942\t\r\n-113.225\t21.0036\t6.6893\t\r\n-72.514\t-107.455\t7.09802\t\r\n81.1576\t23.6564\t6.0266\t\r\n69.0202\t-52.9854\t10.0561\t\r\n"},function(t,e,r){"use strict";var i=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))(function(n,a){function s(t){try{l(i.next(t))}catch(t){a(t)}}function o(t){try{l(i.throw(t))}catch(t){a(t)}}function l(t){t.done?n(t.value):new r(function(e){e(t.value)}).then(s,o)}l((i=i.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});let n=r(3);const a=r(39);e.Skybox=class{constructor(t,e){this.model=new a.SkyboxModel(e),this.model.init(t)}draw(t){this.model.draw(t)}static load(){return i(this,void 0,void 0,function*(){return n.downloadModels([{name:"Skybox",obj:"/assets/models/environment/skybox/Skybox.obj",mtl:"/assets/models/environment/skybox/Skybox.mtl"}])})}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(2);e.SkyboxModel=class extends i.BasicModel{constructor(t){super(t)}init(t){super.init(t),this.initTexture(t,0,!0)||console.warn("Skybox model texture 0 wasn't downloaded")}draw(t){t.bindVertexArray(this.VAO),t.activeTexture(t.TEXTURE0),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,this.mesh.indexBuffer),this.textures.forEach((e,r)=>{let i=this.mesh.vertexBuffer.itemSize,n=this.mesh.submesh[r];t.bindTexture(t.TEXTURE_2D,e),t.drawElements(t.TRIANGLES,this.mesh.indexBuffer.numItems,t.UNSIGNED_SHORT,n.offset*i*2)}),t.bindVertexArray(null)}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(2),n=r(4),a=r(0);e.Renderer=class{constructor(){this.models=new Map,this.materials=new Map,this.entities=new Map,this.meshless_models=new Map}init(t){this.basicModelShader=t}addBasicModel(t){for(var e in void 0===this.models.get(t.mesh.name)&&this.models.set(t.mesh.name,t),t.mesh.materialNames)if(void 0===this.materials.get(t.mesh.materialNames[e])){if(void 0===t.mesh.materialsByIndex[e])throw"Missing material on model";this.materials.set(t.mesh.materialNames[e],t.mesh.materialsByIndex[e])}}addMeshlessModel(t){void 0===this.meshless_models.get(t.name)&&this.meshless_models.set(t.name,t),void 0===this.materials.get(t.material.name)&&this.materials.set(t.material.name,t.material)}addEntityToRenderList(t){void 0===this.entities.get(t.id)&&this.entities.set(t.id,t),t.model_type==n.Model_Type.BASIC?void 0===this.models.get(t.mesh_name)&&console.log("Basic Model Missing: "+t.mesh_name):t.model_type==n.Model_Type.MESHLESS&&void 0===this.meshless_models.get(t.mesh_name)&&console.log("Meshless Model Missing: "+t.mesh_name)}removeEntity(t){this.entities.delete(t.id)}prepareBasicModelShader(t){this.basicModelShader.use(),t.enable(t.DEPTH_TEST),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,i.BasicModel.emptyTexture),t.activeTexture(t.TEXTURE1),t.bindTexture(t.TEXTURE_2D,i.BasicModel.emptyTexture),t.activeTexture(t.TEXTURE2),t.bindTexture(t.TEXTURE_2D,i.BasicModel.emptyTexture),t.activeTexture(t.TEXTURE3),t.bindTexture(t.TEXTURE_2D,i.BasicModel.emptyTexture),t.activeTexture(t.TEXTURE4),t.bindTexture(t.TEXTURE_2D,i.BasicModel.emptyTexture),t.activeTexture(t.TEXTURE5),t.bindTexture(t.TEXTURE_2D,i.BasicModel.emptyTexture),this.basicModelShader.setBool(this.basicModelShader.uniforms.tween_enabled,!1),this.basicModelShader.setInt(this.basicModelShader.uniforms.material_transparency_texture,0),this.basicModelShader.setInt(this.basicModelShader.uniforms.material_emission_texture,1),this.basicModelShader.setInt(this.basicModelShader.uniforms.material_ambient_texture,2),this.basicModelShader.setInt(this.basicModelShader.uniforms.material_diffuse_texture,3),this.basicModelShader.setInt(this.basicModelShader.uniforms.material_specular_texture,4),this.basicModelShader.setInt(this.basicModelShader.uniforms.material_shininess_texture,5),this.basicModelShader.setInt(this.basicModelShader.uniforms.material_transparency_channel,0),this.basicModelShader.setInt(this.basicModelShader.uniforms.material_shininess_channel,0)}render(t,e,r){this.prepareBasicModelShader(t),this.renderMeshlessModels(t,e,r),this.renderBasicModels(t,e,r)}renderMeshlessModels(t,e,r){let s=[];for(const[t,e]of this.meshless_models.entries())s.indexOf(e.material.name)<0&&s.push(e.material.name);for(let o=0;o<s.length;o++){let l=!1;for(const[u,c]of this.meshless_models.entries()){if(c.material.name!==s[o])continue;let u=[];for(const[t,e]of this.entities.entries())e.model_type==n.Model_Type.MESHLESS&&c.name==e.mesh_name&&u.push(e);if(u.length>0){c.activateBuffers(t),l||(c.activateMaterial(t),l=!0);for(let n=0;n<u.length;n++){let s=a.mat4.create();a.mat4.translate(s,s,u[n].position),a.mat4.rotateY(s,s,Math.atan2(u[n].forward[0]+c.rotation_offset[0],u[n].forward[2])+c.rotation_offset[2]),a.mat4.scale(s,s,u[n].scalar),i.BasicModel.setMVPMatrices(s,e,r),c.drawActivatedMaterial(t)}}}}}renderBasicModels(t,e,r){let s=[];for(const[t,e]of this.models.entries())for(const t in e.mesh.materialNames)s.indexOf(e.mesh.materialsByIndex[t].name)<0&&s.push(e.mesh.materialsByIndex[t].name);for(let o=0;o<s.length;o++)for(const[l,u]of this.models.entries()){let l=!0,c=0;for(const e in u.mesh.materialNames)if(u.mesh.materialsByIndex[e]&&u.mesh.materialsByIndex[e].name==s[o]){u.activateMaterial(t,Number(e)),c=Number(e),l=!1;break}if(l)continue;let h=[];for(const[t,e]of this.entities.entries())e.model_type==n.Model_Type.BASIC&&u.mesh.name==e.mesh_name&&h.push(e);if(h.length>0){u.activateBuffers(t);for(let n=0;n<h.length;n++){let s=a.mat4.create();a.mat4.translate(s,s,h[n].position),a.mat4.rotateY(s,s,Math.atan2(h[n].forward[0]+u.rotation_offset[0],h[n].forward[2])+u.rotation_offset[2]),a.mat4.scale(s,s,h[n].scalar),i.BasicModel.setMVPMatrices(s,e,r),u.drawActivatedMaterial(t,c)}}}}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const i=r(12);class n{}e.BasicModelShader=class extends i.Shader{constructor(t,e,r){super(t,e,r),this.uniforms=new n,this.uniforms.model_matrix=this.getUniformLocation("model_matrix"),this.uniforms.view_matrix=this.getUniformLocation("view_matrix"),this.uniforms.model_view_projection_matrix=this.getUniformLocation("model_view_projection_matrix"),this.uniforms.camera_pos=this.getUniformLocation("camera_pos"),this.uniforms.tween_enabled=this.getUniformLocation("tween_enabled"),this.uniforms.material_transparency_texture=this.getUniformLocation("material.transparency_texture"),this.uniforms.material_emission_texture=this.getUniformLocation("material.emission_texture"),this.uniforms.material_ambient_texture=this.getUniformLocation("material.ambient_texture"),this.uniforms.material_diffuse_texture=this.getUniformLocation("material.diffuse_texture"),this.uniforms.material_specular_texture=this.getUniformLocation("material.specular_texture"),this.uniforms.material_shininess_texture=this.getUniformLocation("material.shininess_texture"),this.uniforms.material_transparency_channel=this.getUniformLocation("material.transparency_channel"),this.uniforms.material_shininess_channel=this.getUniformLocation("material.shininess_channel"),this.uniforms.material_transparency=this.getUniformLocation("material.transparency"),this.uniforms.material_ambient_colour=this.getUniformLocation("material.ambient_colour"),this.uniforms.material_diffuse_colour=this.getUniformLocation("material.diffuse_colour"),this.uniforms.material_specular_colour=this.getUniformLocation("material.specular_colour"),this.uniforms.material_emissive_colour=this.getUniformLocation("material.emission_colour"),this.uniforms.material_shininess=this.getUniformLocation("material.shininess"),this.uniforms.material_is_texture_active=this.getUniformLocation("material.is_texture_active")}use(){this.gl.useProgram(this.ID)}setBoolByName(t,e){this.gl.uniform1i(this.getUniformLocation(t),e?1:0)}setBool(t,e){this.gl.uniform1i(t,e?1:0)}setInt(t,e){this.gl.uniform1i(t,e)}setIntByName(t,e){this.gl.uniform1i(this.getUniformLocation(t),e)}setIntV(t,e){this.gl.uniform1iv(t,e)}setIntVByName(t,e){this.gl.uniform1iv(this.getUniformLocation(t),e)}setFloat(t,e){this.gl.uniform1f(t,e)}setFloatByName(t,e){this.gl.uniform1f(this.getUniformLocation(t),e)}getUniformLocation(t){return this.gl.getUniformLocation(this.ID,t)}setMat4(t,e){this.gl.uniformMatrix4fv(t,!1,e)}setMat4ByName(t,e){this.gl.uniformMatrix4fv(this.getUniformLocation(t),!1,e)}setVec3(t,e){this.gl.uniform3fv(t,e)}setVec3ByName(t,e){this.gl.uniform3fv(this.getUniformLocation(t),e)}setVec4(t,e){this.gl.uniform4fv(t,e)}setVec4ByName(t,e){this.gl.uniform4fv(this.getUniformLocation(t),e)}}},function(t,e,r){"use strict";(function(e){function i(t,e){if(t===e)return 0;for(var r=t.length,i=e.length,n=0,a=Math.min(r,i);n<a;++n)if(t[n]!==e[n]){r=t[n],i=e[n];break}return r<i?-1:i<r?1:0}function n(t){return e.Buffer&&"function"==typeof e.Buffer.isBuffer?e.Buffer.isBuffer(t):!(null==t||!t._isBuffer)}var a=r(43),s=Object.prototype.hasOwnProperty,o=Array.prototype.slice,l="foo"===function(){}.name;function u(t){return Object.prototype.toString.call(t)}function c(t){return!n(t)&&("function"==typeof e.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):!!t&&(t instanceof DataView||!!(t.buffer&&t.buffer instanceof ArrayBuffer))))}var h=t.exports=_,d=/\s*function\s+([^\(\s]*)\s*/;function m(t){if(a.isFunction(t)){if(l)return t.name;var e=t.toString().match(d);return e&&e[1]}}function f(t,e){return"string"==typeof t?t.length<e?t:t.slice(0,e):t}function p(t){if(l||!a.isFunction(t))return a.inspect(t);var e=m(t);return"[Function"+(e?": "+e:"")+"]"}function M(t,e,r,i,n){throw new h.AssertionError({message:r,actual:t,expected:e,operator:i,stackStartFunction:n})}function _(t,e){t||M(t,!0,e,"==",h.ok)}function x(t,e,r,s){if(t===e)return!0;if(n(t)&&n(e))return 0===i(t,e);if(a.isDate(t)&&a.isDate(e))return t.getTime()===e.getTime();if(a.isRegExp(t)&&a.isRegExp(e))return t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase;if(null!==t&&"object"==typeof t||null!==e&&"object"==typeof e){if(c(t)&&c(e)&&u(t)===u(e)&&!(t instanceof Float32Array||t instanceof Float64Array))return 0===i(new Uint8Array(t.buffer),new Uint8Array(e.buffer));if(n(t)!==n(e))return!1;var l=(s=s||{actual:[],expected:[]}).actual.indexOf(t);return-1!==l&&l===s.expected.indexOf(e)||(s.actual.push(t),s.expected.push(e),function(t,e,r,i){if(null===t||void 0===t||null===e||void 0===e)return!1;if(a.isPrimitive(t)||a.isPrimitive(e))return t===e;if(r&&Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;var n=b(t),s=b(e);if(n&&!s||!n&&s)return!1;if(n)return t=o.call(t),e=o.call(e),x(t,e,r);var l,u,c=g(t),h=g(e);if(c.length!==h.length)return!1;for(c.sort(),h.sort(),u=c.length-1;u>=0;u--)if(c[u]!==h[u])return!1;for(u=c.length-1;u>=0;u--)if(l=c[u],!x(t[l],e[l],r,i))return!1;return!0}(t,e,r,s))}return r?t===e:t==e}function b(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function v(t,e){if(!t||!e)return!1;if("[object RegExp]"==Object.prototype.toString.call(e))return e.test(t);try{if(t instanceof e)return!0}catch(t){}return!Error.isPrototypeOf(e)&&!0===e.call({},t)}function y(t,e,r,i){var n;if("function"!=typeof e)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(i=r,r=null),n=function(t){var e;try{t()}catch(t){e=t}return e}(e),i=(r&&r.name?" ("+r.name+").":".")+(i?" "+i:"."),t&&!n&&M(n,r,"Missing expected exception"+i);var s="string"==typeof i,o=!t&&a.isError(n),l=!t&&n&&!r;if((o&&s&&v(n,r)||l)&&M(n,r,"Got unwanted exception"+i),t&&n&&r&&!v(n,r)||!t&&n)throw n}h.AssertionError=function(t){var e;this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=f(p((e=this).actual),128)+" "+e.operator+" "+f(p(e.expected),128),this.generatedMessage=!0);var r=t.stackStartFunction||M;if(Error.captureStackTrace)Error.captureStackTrace(this,r);else{var i=new Error;if(i.stack){var n=i.stack,a=m(r),s=n.indexOf("\n"+a);if(s>=0){var o=n.indexOf("\n",s+1);n=n.substring(o+1)}this.stack=n}}},a.inherits(h.AssertionError,Error),h.fail=M,h.ok=_,h.equal=function(t,e,r){t!=e&&M(t,e,r,"==",h.equal)},h.notEqual=function(t,e,r){t==e&&M(t,e,r,"!=",h.notEqual)},h.deepEqual=function(t,e,r){x(t,e,!1)||M(t,e,r,"deepEqual",h.deepEqual)},h.deepStrictEqual=function(t,e,r){x(t,e,!0)||M(t,e,r,"deepStrictEqual",h.deepStrictEqual)},h.notDeepEqual=function(t,e,r){x(t,e,!1)&&M(t,e,r,"notDeepEqual",h.notDeepEqual)},h.notDeepStrictEqual=function t(e,r,i){x(e,r,!0)&&M(e,r,i,"notDeepStrictEqual",t)},h.strictEqual=function(t,e,r){t!==e&&M(t,e,r,"===",h.strictEqual)},h.notStrictEqual=function(t,e,r){t===e&&M(t,e,r,"!==",h.notStrictEqual)},h.throws=function(t,e,r){y(!0,t,e,r)},h.doesNotThrow=function(t,e,r){y(!1,t,e,r)},h.ifError=function(t){if(t)throw t};var g=Object.keys||function(t){var e=[];for(var r in t)s.call(t,r)&&e.push(r);return e}}).call(e,r(17))},function(t,e,r){(function(t,i){var n=/%[sdj%]/g;e.format=function(t){if(!_(t)){for(var e=[],r=0;r<arguments.length;r++)e.push(o(arguments[r]));return e.join(" ")}r=1;for(var i=arguments,a=i.length,s=String(t).replace(n,function(t){if("%%"===t)return"%";if(r>=a)return t;switch(t){case"%s":return String(i[r++]);case"%d":return Number(i[r++]);case"%j":try{return JSON.stringify(i[r++])}catch(t){return"[Circular]"}default:return t}}),l=i[r];r<a;l=i[++r])p(l)||!v(l)?s+=" "+l:s+=" "+o(l);return s},e.deprecate=function(r,n){if(x(t.process))return function(){return e.deprecate(r,n).apply(this,arguments)};if(!0===i.noDeprecation)return r;var a=!1;return function(){if(!a){if(i.throwDeprecation)throw new Error(n);i.traceDeprecation?console.trace(n):console.error(n),a=!0}return r.apply(this,arguments)}};var a,s={};function o(t,r){var i={seen:[],stylize:u};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),f(r)?i.showHidden=r:r&&e._extend(i,r),x(i.showHidden)&&(i.showHidden=!1),x(i.depth)&&(i.depth=2),x(i.colors)&&(i.colors=!1),x(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=l),c(i,t,i.depth)}function l(t,e){var r=o.styles[e];return r?"["+o.colors[r][0]+"m"+t+"["+o.colors[r][1]+"m":t}function u(t,e){return t}function c(t,r,i){if(t.customInspect&&r&&E(r.inspect)&&r.inspect!==e.inspect&&(!r.constructor||r.constructor.prototype!==r)){var n=r.inspect(i,t);return _(n)||(n=c(t,n,i)),n}var a=function(t,e){if(x(e))return t.stylize("undefined","undefined");if(_(e)){var r="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(r,"string")}if(M(e))return t.stylize(""+e,"number");if(f(e))return t.stylize(""+e,"boolean");if(p(e))return t.stylize("null","null")}(t,r);if(a)return a;var s=Object.keys(r),o=function(t){var e={};return t.forEach(function(t,r){e[t]=!0}),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(r)),g(r)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(r);if(0===s.length){if(E(r)){var l=r.name?": "+r.name:"";return t.stylize("[Function"+l+"]","special")}if(b(r))return t.stylize(RegExp.prototype.toString.call(r),"regexp");if(y(r))return t.stylize(Date.prototype.toString.call(r),"date");if(g(r))return h(r)}var u,v="",w=!1,T=["{","}"];(m(r)&&(w=!0,T=["[","]"]),E(r))&&(v=" [Function"+(r.name?": "+r.name:"")+"]");return b(r)&&(v=" "+RegExp.prototype.toString.call(r)),y(r)&&(v=" "+Date.prototype.toUTCString.call(r)),g(r)&&(v=" "+h(r)),0!==s.length||w&&0!=r.length?i<0?b(r)?t.stylize(RegExp.prototype.toString.call(r),"regexp"):t.stylize("[Object]","special"):(t.seen.push(r),u=w?function(t,e,r,i,n){for(var a=[],s=0,o=e.length;s<o;++s)A(e,String(s))?a.push(d(t,e,r,i,String(s),!0)):a.push("");return n.forEach(function(n){n.match(/^\d+$/)||a.push(d(t,e,r,i,n,!0))}),a}(t,r,i,o,s):s.map(function(e){return d(t,r,i,o,e,w)}),t.seen.pop(),function(t,e,r){if(t.reduce(function(t,e){return 0,e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60)return r[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+r[1];return r[0]+e+" "+t.join(", ")+" "+r[1]}(u,v,T)):T[0]+v+T[1]}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function d(t,e,r,i,n,a){var s,o,l;if((l=Object.getOwnPropertyDescriptor(e,n)||{value:e[n]}).get?o=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(o=t.stylize("[Setter]","special")),A(i,n)||(s="["+n+"]"),o||(t.seen.indexOf(l.value)<0?(o=p(r)?c(t,l.value,null):c(t,l.value,r-1)).indexOf("\n")>-1&&(o=a?o.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+o.split("\n").map(function(t){return"   "+t}).join("\n")):o=t.stylize("[Circular]","special")),x(s)){if(a&&n.match(/^\d+$/))return o;(s=JSON.stringify(""+n)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+o}function m(t){return Array.isArray(t)}function f(t){return"boolean"==typeof t}function p(t){return null===t}function M(t){return"number"==typeof t}function _(t){return"string"==typeof t}function x(t){return void 0===t}function b(t){return v(t)&&"[object RegExp]"===w(t)}function v(t){return"object"==typeof t&&null!==t}function y(t){return v(t)&&"[object Date]"===w(t)}function g(t){return v(t)&&("[object Error]"===w(t)||t instanceof Error)}function E(t){return"function"==typeof t}function w(t){return Object.prototype.toString.call(t)}function T(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(x(a)&&(a=i.env.NODE_DEBUG||""),t=t.toUpperCase(),!s[t])if(new RegExp("\\b"+t+"\\b","i").test(a)){var r=i.pid;s[t]=function(){var i=e.format.apply(e,arguments);console.error("%s %d: %s",t,r,i)}}else s[t]=function(){};return s[t]},e.inspect=o,o.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},o.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=m,e.isBoolean=f,e.isNull=p,e.isNullOrUndefined=function(t){return null==t},e.isNumber=M,e.isString=_,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=x,e.isRegExp=b,e.isObject=v,e.isDate=y,e.isError=g,e.isFunction=E,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=r(45);var R=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function A(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){var t,r;console.log("%s - %s",(t=new Date,r=[T(t.getHours()),T(t.getMinutes()),T(t.getSeconds())].join(":"),[t.getDate(),R[t.getMonth()],r].join(" ")),e.format.apply(e,arguments))},e.inherits=r(46),e._extend=function(t,e){if(!e||!v(e))return t;for(var r=Object.keys(e),i=r.length;i--;)t[r[i]]=e[r[i]];return t}}).call(e,r(17),r(44))},function(t,e){var r,i,n=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(t){if(r===setTimeout)return setTimeout(t,0);if((r===a||!r)&&setTimeout)return r=setTimeout,setTimeout(t,0);try{return r(t,0)}catch(e){try{return r.call(null,t,0)}catch(e){return r.call(this,t,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:a}catch(t){r=a}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var l,u=[],c=!1,h=-1;function d(){c&&l&&(c=!1,l.length?u=l.concat(u):h=-1,u.length&&m())}function m(){if(!c){var t=o(d);c=!0;for(var e=u.length;e;){for(l=u,u=[];++h<e;)l&&l[h].run();h=-1,e=u.length}l=null,c=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];u.push(new f(t,e)),1!==u.length||c||o(m)},f.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},function(t,e,r){var i,n;!function(a){var s,o,l,u,c=1e3/60,h=0,d=0,m=60,f=.9,p=1e3,M=0,_=0,x=0,b=0,v=!1,y=!1,g=!1,E="object"==typeof window?window:a,w=E.requestAnimationFrame||(u=Date.now(),function(t){return o=Date.now(),l=Math.max(0,c-(o-u)),u=o+l,setTimeout(function(){t(o+l)},l)}),T=E.cancelAnimationFrame||clearTimeout,R=function(){},A=R,S=R,I=R,D=R;function B(t){if(s=w(B),!(t<d+b)){for(h+=t-d,d=t,A(t,h),t>M+p&&(m=f*_*1e3/(t-M)+(1-f)*m,M=t,_=0),_++,x=0;h>=c;)if(S(c),h-=c,++x>=240){g=!0;break}I(h/c),D(m,g),g=!1}}a.MainLoop={getSimulationTimestep:function(){return c},setSimulationTimestep:function(t){return c=t,this},getFPS:function(){return m},getMaxAllowedFPS:function(){return 1e3/b},setMaxAllowedFPS:function(t){return void 0===t&&(t=1/0),0===t?this.stop():b=1e3/t,this},resetFrameDelta:function(){var t=h;return h=0,t},setBegin:function(t){return A=t||A,this},setUpdate:function(t){return S=t||S,this},setDraw:function(t){return I=t||I,this},setEnd:function(t){return D=t||D,this},start:function(){return y||(y=!0,s=w(function(t){I(1),v=!0,d=t,M=t,_=0,s=w(B)})),this},stop:function(){return v=!1,y=!1,T(s),this},isRunning:function(){return v}},i=a.MainLoop,void 0===(n="function"==typeof i?i.call(e,r,e,t):i)||(t.exports=n)}(this)},function(t,e){t.exports="#version 300 es\r\nlayout (location = 0) in vec3 aPos;\r\nlayout (location = 1) in vec2 aTexCoord;\r\n\r\nout vec2 TexCoord;\r\n\r\nuniform mat4 model;\r\nuniform mat4 viewProjection;\r\n\r\nvoid main()\r\n{\r\n    gl_Position = viewProjection * model *  vec4(aPos,1.0f);\r\n    TexCoord = aTexCoord;\r\n}   "},function(t,e){t.exports="#version 300 es\r\nprecision mediump  float;\r\nout vec4 FragColor;\r\n\r\nin vec2 TexCoord;\r\n\r\nuniform sampler2D texture1;\r\nuniform float ambient;\r\n\r\nvoid main()\r\n{\r\n    FragColor = vec4(ambient * texture(texture1, TexCoord).xyz,1.0);\r\n\r\n    //FragColor = vec4(1, 0.7, 0.5, 1); // set all 4 vector values to 1.0\r\n}"},function(t,e){t.exports="#version 300 es\r\n\r\nuniform mat4 model_matrix;\r\nuniform mat4 view_matrix;\r\nuniform mat4 model_view_projection_matrix;\r\nuniform vec3 camera_pos;\r\n\r\nuniform bool tween_enabled;\r\nuniform float tween_factor;\r\n\r\nlayout (location = 0) in vec3 a_vertex;\r\nlayout (location = 1) in vec2 a_tex_coord;\r\nlayout (location = 2) in vec3 a_normal;\r\n\r\n\r\nout vec3 position;\r\nout vec2 tex_coord;\r\nout vec3 normal;\r\nout vec3 to_camera;\r\n\r\nvoid main()\r\n{\r\n//    vec3 new_normal = a_normal;\r\n//    vec3 new_vertex = a_vertex;\r\n//    if(tween_enabled)\r\n//\t{\r\n//\t\tnew_normal = mix(a_normal,a_normal1,tween_factor);      \r\n//        new_vertex = mix(a_vertex,a_vertex1,tween_factor);\r\n//    }\r\n\t\r\n\tvec4 world_position = model_matrix * vec4(a_vertex, 1.0);\r\n\r\n\tposition   = world_position.xyz;\r\n\ttex_coord = a_tex_coord;\r\n\tnormal    = mat3(transpose(inverse(model_matrix))) * a_normal;\r\n\tto_camera  = normalize(camera_pos - world_position.xyz);\r\n\r\n\tgl_Position = model_view_projection_matrix * vec4(a_vertex, 1.0);\r\n}\r\n"},function(t,e){t.exports="#version 300 es\r\nprecision mediump  float;\r\n\r\nconst int LIGHT_COUNT = 8;\r\n\r\nstruct Material {\r\n\r\n    //Textures\r\n    bool is_texture_active[6];\r\n    sampler2D transparency_texture;\r\n    sampler2D emission_texture;\r\n    sampler2D ambient_texture;\r\n    sampler2D diffuse_texture;\r\n    sampler2D specular_texture;\r\n    sampler2D shininess_texture;\r\n            \r\n    //Colors\r\n    float transparency;\r\n    vec3 emission_colour;\r\n    vec3 ambient_colour;\r\n    vec3 diffuse_colour;\r\n    vec3 specular_colour;\r\n    float shininess;\r\n    int transparency_channel;\r\n    int shininess_channel;\r\n\r\n}; \r\nuniform Material material;\r\n\r\n\r\nstruct Light{\r\n    bool is_enabled;\r\n    vec4 position;\r\n    vec3 ambient;\r\n    vec3 diffuse;\r\n    vec3 specular;\r\n    vec3 attenuation;\r\n};\r\n\r\nuniform Light lights[LIGHT_COUNT];\r\n\r\nin vec3 position;\r\nin vec2 tex_coord;\r\nin vec3 normal;\r\nin vec3 to_camera;\r\n\r\nout vec4 FragColor;\r\n\r\nvoid main()\r\n{\r\n\r\n\r\n\tvec3 normalized_normal    = normalize(normal);\r\n\tvec3 normalized_to_camera = normalize(to_camera);\r\n\r\n\tfloat transparency_on_texture = texture(material.transparency_texture, tex_coord)[material.transparency_channel];\r\n\tvec3      emission_on_texture = texture(    material.emission_texture, tex_coord).rgb;\r\n\tvec3       ambient_on_texture = texture(     material.ambient_texture, tex_coord).rgb;\r\n\tvec3       diffuse_on_texture = texture(     material.diffuse_texture, tex_coord).rgb;\r\n\tvec3      specular_on_texture = texture(    material.specular_texture, tex_coord).rgb;\r\n\tfloat    shininess_on_texture = texture(   material.shininess_texture, tex_coord)[material.shininess_channel];\r\n\r\n\tfloat transparency2    = material.transparency;\r\n\tvec3  emission_surface = material.emission_colour;\r\n\tvec3   ambient_surface =  material.ambient_colour;\r\n\tvec3   diffuse_surface =  material.diffuse_colour;\r\n\tvec3  specular_surface = material.specular_colour;\r\n\tfloat shininess2       = material.shininess;\r\n\r\n\tif(material.is_texture_active[0]) transparency2    *= transparency_on_texture;\r\n\tif(material.is_texture_active[1]) emission_surface *=     emission_on_texture;\r\n\tif(material.is_texture_active[2])  ambient_surface *=      ambient_on_texture;\r\n\tif(material.is_texture_active[3])  diffuse_surface *=      diffuse_on_texture;\r\n\tif(material.is_texture_active[4]) specular_surface *=     specular_on_texture;\r\n\tif(material.is_texture_active[5]) shininess2       *=    shininess_on_texture;\r\n\r\n\tvec3 basic_colour      = emission_surface;\r\n\tvec4 seperate_specular = vec4(0.0, 0.0, 0.0, 0.0);\r\n\r\n\t// calculate the effects of each light\r\n\r\n\tfor(int i = 0; i < LIGHT_COUNT; i++)\r\n\t\tif(lights[i].is_enabled)\r\n\t\t{\r\n\t\t\tvec3 light_direction_from;\r\n\t\t\tfloat attenuation = 1.0;\r\n\t\t\tif(lights[i].position.w == 0.0)\r\n\t\t\t\tlight_direction_from = normalize(lights[i].position.xyz);\r\n\t\t\telse\r\n\t\t\t{\r\n\t\t\t\tvec3 offset_position = lights[i].position.xyz - position;\r\n\t\t\t\tlight_direction_from = normalize(offset_position);\r\n\t\t\t\tfloat light_distance = length(offset_position);\r\n\t\t\t\tattenuation = 1.0 / (lights[i].attenuation.x +\r\n\t\t\t\t                  lights[i].attenuation.y * light_distance +\r\n\t\t\t\t                    lights[i].attenuation.z * light_distance * light_distance);\r\n\t\t\t}\r\n\r\n\t\t\t//  Phong-Blinn shading\r\n\r\n\t\t\tvec3 half_angle_direction = normalize(normalized_to_camera + light_direction_from);\r\n\r\n\t\t\tfloat  ambient_intensity = attenuation;\r\n\t\t\tfloat  diffuse_intensity = attenuation *     max(0.0, dot(normalized_normal, light_direction_from));\r\n\t\t\tfloat specular_intensity = attenuation * pow(max(0.0, dot(normalized_normal, half_angle_direction)), shininess2);\r\n\r\n\t\t\tbasic_colour += ambient_surface * lights[i].ambient * ambient_intensity +\r\n\t\t\t                diffuse_surface * lights[i].diffuse * diffuse_intensity;\r\n\r\n\t\t\tvec3 specular_colour = specular_surface * lights[i].specular;\r\n//\t\t\tif(is_seperate_specular)\r\n//\t\t\t{\r\n//\t\t\t\tfloat specular_max = max(max(specular_colour.r, specular_colour.g), specular_colour.b);\r\n//\t\t\t\tif(specular_max > 0.0)\r\n//\t\t\t\t{\r\n//\t\t\t\t\tspecular_intensity *= specular_max;\r\n//\t\t\t\t\tspecular_colour    /= specular_max;\r\n//\r\n//\t\t\t\t\tseperate_specular = vec4(seperate_specular.rgb * seperate_specular.a +\r\n//\t\t\t\t\t                         specular_colour       * specular_intensity,\r\n//\t\t\t\t\t                         seperate_specular.a + specular_intensity);\r\n//\t\t\t\t}\r\n//\t\t\t\t// else no specular highlight\r\n//\t\t\t}\r\n//\t\t\telse\r\n\t\t\t\tbasic_colour += specular_colour * specular_intensity;\r\n\t\t}\r\n\r\n\t// calculate the final colour\r\n\r\n\tif(seperate_specular.a > 1.0)\r\n\t\tseperate_specular.a = 1.0;\r\n\r\n\tfloat basic_transparency = transparency2 * (1.0 - seperate_specular.a);\r\n\r\n\tif(basic_transparency + seperate_specular.a <= 0.0)\r\n\t\tdiscard;\r\n\r\n\tFragColor = vec4(basic_colour, basic_transparency) + seperate_specular;\r\n}\r\n"}]);